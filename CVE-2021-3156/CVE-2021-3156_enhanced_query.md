# Enhanced Query for CVE-2021-3156

## Vulnerability Description
Sudo before 1.9.5p2 contains an **off-by-one error** that can result in a **heap-based buffer overflow**, which allows privilege escalation to root via "sudoedit -s" and a command-line argument that ends with a single backslash character.

### Vulnerability Description Key Phrases
- **rootcause:** **off-by-one error**
- **weakness:** **heap-based buffer overflow**
- **impact:** privilege escalation to root
- **vector:** command-line argument ending with single backslash
- **product:** Sudo
- **version:** before 1.9.5p2

## CVE Reference Links Content Summary
```json
{
  "guidelines": "1. First verify if the content relates to the CVE specified based on the official description\n2. If the content does not relate to this CVE, respond with \"UNRELATED\"\n3. If no useful vulnerability information is found, respond with \"NOINFO\" \n4. For relevant content, extract:\n   - Root cause of vulnerability\n   - Weaknesses/vulnerabilities present\n   - Impact of exploitation\n   - Attack vectors\n   - Required attacker capabilities/position\n\nAdditional instructions:\n- Preserve original technical details and descriptions\n- Remove unrelated content\n- Translate non-English content to English\n- Note if the content provides more detail than the official CVE description",
  "response": {
    "CVE-2021-3156": [
      {
        "content_source": "www.kb.cert.org_ddfaa341_20250108_124807.html",
        "root_cause": "A heap-based buffer overflow exists in the `set_cmd()` function of sudo.",
        "weaknesses": [
          "Heap-based buffer overflow"
        ],
        "impact": "A local non-administrative attacker can elevate their privileges to execute commands with administrator privileges.",
        "attack_vectors": [
          "Local access to an affected machine"
        ],
        "required_attacker_capabilities": [
          "Local access to an affected machine"
        ]
      },
      {
        "content_source": "github.com_97ef01f3_20250108_153957.html",
         "root_cause": "NOINFO",
        "weaknesses": "NOINFO",
        "impact": "NOINFO",
        "attack_vectors": "NOINFO",
        "required_attacker_capabilities": "NOINFO"
      },
      {
        "content_source": "www.openwall.com_979606b3_20250108_124757.html",
        "root_cause": "A heap-based buffer overflow vulnerability exists in the `set_cmd()` function in sudo where if a command-line argument ends with a single backslash character, an out-of-bounds memory copy occurs due to improper unescaping.",
        "weaknesses": [
          "Heap-based buffer overflow due to incorrect unescaping of a backslash character in command-line arguments."
        ],
        "impact": "Any local user can gain root privileges on a vulnerable host with a default sudo configuration. Allows attackers to control the size of the user_args buffer that they overflow and independently control the size and content of the overflow.",
        "attack_vectors": [
          "Exploitable via the `sudoedit -s` command with a command-line argument ending in a backslash character."
        ],
         "required_attacker_capabilities": [
          "Local user (normal and system users, sudoers and non-sudoers)."
        ],
         "additional_details": "This vulnerability is present in legacy versions from 1.8.2 to 1.8.31p2 and all stable versions from 1.9.0 to 1.9.5p1. Exploit techniques include overwriting struct sudo_hook_entry to redirect code execution, overwriting heap-based struct nss_module name[], or overwriting def_timestampdir with an arbitrary symlink."
      },
     {
        "content_source": "sec.cloudapps.cisco.com_fee78a22_20250108_153952.html",
        "root_cause": "Improper parsing of command line parameters in Sudo may result in a heap-based buffer overflow. Specifically, crafted parameters passed to sudoedit can cause a heap-based buffer overflow.",
        "weaknesses": [
          "Improper parsing of command line parameters resulting in a heap-based buffer overflow"
        ],
        "impact": "An authenticated, local attacker can execute commands or binaries with root privileges.",
        "attack_vectors": [
          "Accessing a Unix shell on an affected device and invoking the `sudoedit` command with crafted parameters or by executing a binary exploit."
        ],
         "required_attacker_capabilities": [
           "An authenticated local attacker capable of accessing a Unix shell on an affected device"
        ]
      },
   {
        "content_source": "github.com_f0514a42_20250108_153956.html",
         "root_cause": "NOINFO",
        "weaknesses": "NOINFO",
        "impact": "NOINFO",
        "attack_vectors": "NOINFO",
        "required_attacker_capabilities": "NOINFO"
      },
      {
        "content_source": "www.debian.org_9de40279_20250108_124800.html",
        "root_cause": "A heap-based buffer overflow vulnerability was found in sudo, a program designed to provide limited super user privileges to specific users.",
        "weaknesses": [
          "Heap-based buffer overflow"
        ],
         "impact": "Local users can exploit this flaw for root privilege escalation.",
        "attack_vectors": [
            "Local users (sudoers and non-sudoers)"
          ],
        "required_attacker_capabilities": [
            "Local user access"
          ]
      },
        {
        "content_source": "security.gentoo.org_08e70803_20250108_124802.html",
        "root_cause": "A heap-based buffer overflow vulnerability exists in sudo.",
        "weaknesses": [
          "Heap-based buffer overflow."
        ],
        "impact": "Local users can gain unauthorized privileges on the system.",
        "attack_vectors": [
          "Local"
        ],
          "required_attacker_capabilities": [
             "Local user access"
          ]
      },
      {
        "content_source": "tools.cisco.com_fdff3844_20250108_124805.html",
       "root_cause": "Improper parsing of command line parameters in Sudo may result in a heap-based buffer overflow. Specifically, crafted parameters passed to sudoedit can cause a heap-based buffer overflow.",
        "weaknesses": [
          "Improper parsing of command line parameters resulting in a heap-based buffer overflow"
        ],
        "impact": "An authenticated, local attacker can execute commands or binaries with root privileges.",
        "attack_vectors": [
          "Accessing a Unix shell on an affected device and invoking the `sudoedit` command with crafted parameters or by executing a binary exploit."
        ],
          "required_attacker_capabilities": [
           "An authenticated local attacker capable of accessing a Unix shell on an affected device"
        ]
      },
      {
        "content_source": "www.openwall.com_67a199a4_20250108_124758.html",
         "root_cause": "Out-of-bounds read/write vulnerability during argument unescaping in `set_cmnd()` in sudo, specifically when a command-line argument ends with a single backslash character.",
        "weaknesses": [
          "Heap-based buffer overflow due to improper unescaping of backslash characters in command line arguments"
        ],
        "impact": "Local attackers can achieve privilege escalation and execute code as root.",
        "attack_vectors": [
          "The vulnerability can be exploited by running sudoedit with a specially crafted command-line argument that ends with a single backslash character."
        ],
         "required_attacker_capabilities": [
           "Requires local user access, without needing sudoers permissions or the user password."
         ]
      },
      {
        "content_source": "www.synology.com_cd476a8e_20250108_124818.html",
        "root_cause": "Heap-based buffer overflow when processing command line arguments.",
        "weaknesses": [
          "Heap-based buffer overflow"
        ],
          "impact": "Local users can conduct privilege escalation attacks.",
         "attack_vectors": [
           "Local access to a susceptible system"
        ],
        "required_attacker_capabilities": [
           "Local access"
        ]
     },
     {
        "content_source": "seclists.org_0b3cd48b_20250108_124756.html",
        "root_cause": "A heap-based buffer overflow exists in sudo due to improper handling of a backslash character at the end of a command-line argument during parsing.",
        "weaknesses": [
          "Heap-based buffer overflow."
        ],
        "impact": "Any local user can gain root privileges on a vulnerable host with a default sudo configuration.",
         "attack_vectors": [
            "Exploitable when sudo is executed in shell mode using -s or -i option with a command-line argument that ends with a single backslash character."
        ],
        "required_attacker_capabilities": [
            "A local user, including non-sudo users and non-administrative users."
          ]
     },
      {
        "content_source": "ubuntu.com_bebfc6e2_20250108_153945.html",
       "root_cause": "An off-by-one error in Sudo's parsing of command line parameters, leading to a heap-based buffer overflow.",
        "weaknesses": [
           "Off-by-one error resulting in heap-based buffer overflow."
        ],
        "impact": "Privilege escalation to root.",
        "attack_vectors": [
          "`sudoedit -s` with a command-line argument ending with a single backslash character."
        ],
        "required_attacker_capabilities": [
             "Local access"
          ]
      },
    {
        "content_source": "www.openwall.com_8b0d7e67_20250108_124758.html",
         "root_cause": "A minor bug in sudo where the NO_ROOT_MAILER flag which was meant to harden sudo and avoid using mailer was broken.",
          "weaknesses": [
          "Broken hardening option (NO_ROOT_MAILER) in sudo that eases exploitation of the heap overflow."
        ],
        "impact": "Makes exploit easier by allowing for more direct control of heap memory layout.",
        "attack_vectors": [
            "Local access with an exploit for CVE-2021-3156."
          ],
          "required_attacker_capabilities": [
            "Local user with sudo access"
          ],
         "additional_details": " This bug is used in combination with the Baron Samedit heap overflow. With NO_ROOT_MAILER working, the exploit is ~156 lines of code, whereas without it, the exploit is ~43 lines long. This highlights how the broken hardening mechanism increases exploit complexity"
      },
        {
        "content_source": "blog.qualys.com_e270e781_20250108_153946.html",
        "root_cause": "Heap overflow vulnerability in the `set_cmnd()` function in Sudo due to incorrect parsing of command line arguments. Specifically, if a command-line argument ends with a single backslash character, `set_cmnd()` performs an out-of-bounds copy to a heap buffer.",
        "weaknesses": [
          "Heap-based buffer overflow",
           "Improper argument handling"
        ],
        "impact": "Any unprivileged local user can gain root privileges on a vulnerable host. This is due to being able to control the size of the user_args buffer being overflowed and size and content of the overflow itself.",
        "attack_vectors": [
            "`sudoedit -s` with a command-line argument ending with a single backslash character."
          ],
        "required_attacker_capabilities": [
           "Any local user (normal users and system users, sudoers and non-sudoers)."
        ],
         "additional_details": "Vulnerability introduced in July 2011, and affects versions 1.8.2 to 1.8.31p2 and 1.9.0 to 1.9.5p1. Three exploits were developed that obtained full root privileges on Ubuntu 20.04, Debian 10, and Fedora 33."
    },
    {
        "content_source": "sec.cloudapps.cisco.com_89db7c50_20250108_153953.html",
        "root_cause": "Improper parsing of command line parameters in Sudo, resulting in a heap-based buffer overflow.",
        "weaknesses": [
            "Improper command-line parameter parsing",
            "Heap-based buffer overflow."
        ],
        "impact": "An authenticated local attacker may execute commands or binaries with root privileges.",
         "attack_vectors": [
            "Accessing a Unix shell on an affected device and then invoking the `sudoedit` command with crafted parameters or by executing a binary exploit."
        ],
           "required_attacker_capabilities": [
            "An authenticated local attacker, with access to a Unix shell on an affected device"
          ]
      },
      {
        "content_source": "www.openwall.com_bc3f8cce_20250108_124757.html",
         "root_cause": "Heap-based buffer overflow in Sudo's set_cmnd() function when handling arguments ending with a backslash. Specifically, during the unescaping of command line arguments in sudoedit.",
        "weaknesses": [
          "Heap-based buffer overflow due to improper unescaping."
        ],
        "impact": "Privilege escalation to root",
        "attack_vectors": [
             "The vulnerability is triggered by using sudoedit with the `-s` option, followed by an argument ending with a single backslash character."
           ],
          "required_attacker_capabilities": [
            "No specific privilege requirements, any local user can exploit this."
        ]
      },
      {
        "content_source": "www.suse.com_53fb7cb8_20250108_153947.html",
       "root_cause": "Off-by-one error in Sudo before 1.9.5p2 can result in a heap-based buffer overflow.",
         "weaknesses": [
             "Off-by-one error leading to heap-based buffer overflow"
          ],
        "impact": "Privilege escalation to root",
        "attack_vectors": [
            "sudoedit -s and a command-line argument that ends with a single backslash character."
        ],
         "required_attacker_capabilities": [
           "Local user"
        ]
      },
      {
         "content_source": "tools.cisco.com_fdff3844_20250108_124805.html",
           "root_cause": "Improper command line parameter parsing, specifically in the `sudoedit` command, which can lead to a heap-based buffer overflow.",
           "weaknesses": [
             "Heap-based buffer overflow",
             "Improper command-line parameter parsing"
            ],
         "impact": "An authenticated, local attacker can execute commands or binaries with root privileges.",
         "attack_vectors": [
            "Access a Unix shell on an affected device and then invoke the sudoedit command with crafted parameters or by executing a binary exploit."
           ],
            "required_attacker_capabilities": [
           "Authenticated local user access"
         ]
    },
{
    "content_source": "www.openwall.com_068cc409_20250108_124757.html",
        "root_cause": "A heap-based buffer overflow in `sudo` occurs due to how the utility processes command-line arguments, particularly when an argument ends with a backslash character. The vulnerability occurs in the `set_cmnd()` function.",
        "weaknesses": [
          "Heap-based buffer overflow"
        ],
        "impact": "A local user can escalate privileges to root.",
         "attack_vectors": [
           "A specially crafted command-line argument used with `sudoedit -s` where a single backslash is the last character before the null terminator"
         ],
        "required_attacker_capabilities": [
            "Local unprivileged user access."
          ]
    },
    {
        "content_source": "www.openwall.com_a53720b4_20250108_124758.html",
       "root_cause": "The glibc's __vsyslog_internal() function has a heap-based buffer overflow due to improper handling of the program name (argv[0] or openlog() ident argument) length.",
        "weaknesses": [
            "Heap-based buffer overflow.",
            "Improper handling of long program name strings in syslog."
          ],
         "impact": "Local Privilege Escalation, from any unprivileged user to full root.",
         "attack_vectors": [
            "Local user access"
          ],
        "required_attacker_capabilities": [
          "Local, unprivileged user access"
         ]
      },
      {
        "content_source": "packetstormsecurity.com_4186acd1_20250108_124755.html",
          "root_cause": "NOINFO",
          "weaknesses": "NOINFO",
        "impact": "NOINFO",
        "attack_vectors": "NOINFO",
          "required_attacker_capabilities": "NOINFO"
      },
        {
        "content_source": "packetstormsecurity.com_0f0d5e18_20250108_124751.html",
        "root_cause": "NOINFO",
          "weaknesses": "NOINFO",
        "impact": "NOINFO",
        "attack_vectors": "NOINFO",
          "required_attacker_capabilities": "NOINFO"
      },
          {
        "content_source": "packetstormsecurity.com_4b97e923_20250108_124753.html",
          "root_cause": "NOINFO",
        "weaknesses": "NOINFO",
        "impact": "NOINFO",
        "attack_vectors": "NOINFO",
         "required_attacker_capabilities": "NOINFO"
       },
     {
        "content_source": "kc.mcafee.com_8fe1da70_20250108_124759.html",
        "root_cause": "NOINFO",
        "weaknesses": "NOINFO",
        "impact": "NOINFO",
        "attack_vectors": "NOINFO",
         "required_attacker_capabilities": "NOINFO"
       },
     {
        "content_source": "lists.fedoraproject.org_71b49072_20250108_124800.html",
           "root_cause": "NOINFO",
        "weaknesses": "NOINFO",
         "impact": "NOINFO",
        "attack_vectors": "NOINFO",
         "required_attacker_capabilities": "NOINFO"
      },
      {
        "content_source": "www.openwall.com_a436ebfc_20250108_124758.html",
        "root_cause": "A heap-based buffer overflow in Sudo, specifically when the name[] field of a heap-based struct nss_module is overwritten, combined with an overwrite of def_timestampdir.",
         "weaknesses": [
          "Heap-based buffer overflow.",
            "Improper overwrite of function pointers"
          ],
        "impact": "Privilege escalation to root, arbitrary code execution.",
         "attack_vectors": [
           "Local access via command line arguments, leveraging how Sudo uses setlocale() and handles directory creation. Also includes ability to execute arbitrary shared library loaded by Sudo with root privileges when nss_module struct is corrupted."
         ],
          "required_attacker_capabilities": [
              "Local User access to system"
          ]
      },
      {
        "content_source": "www.openwall.com_d2a06585_20250108_124757.html",
          "root_cause": "A heap-based buffer overflow in the GNU C Library's __vsyslog_internal() function, which is called by both syslog() and vsyslog().  The vulnerability is due to how the function handles program names that are longer than 1024 bytes.",
        "weaknesses": [
          "Heap-based buffer overflow in syslog function",
          "Insecure handling of program name length"
        ],
        "impact": "Local Privilege Escalation, from any unprivileged user to full root. Allows attacker to overwrite arbitrary memory on the heap by controlling the program's argv[0] and environment variables.",
         "attack_vectors": [
            "Exploited using the `su` command with a long program name for argv[0] that is larger than 1024 bytes combined with a crafted whitelist option.",
           "Local access required"
        ],
           "required_attacker_capabilities": [
           "Local user access"
          ]
      },
       {
         "content_source": "support.apple.com_8479d2e8_20250108_124803.html",
           "root_cause": "Vulnerability exists in sudo where the issue is addressed by updating to sudo version 1.9.5p2.",
           "weaknesses": [
             "Buffer overflow"
           ],
           "impact": "A local attacker may be able to elevate their privileges",
        "attack_vectors": [
            "Local access."
         ],
            "required_attacker_capabilities": [
              "Local user access."
            ]
        }

    ]
  }
}
```

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 119 | Improper Restriction of Operations within the Bounds of a Memory Buffer | Class | Discouraged | alternate_terms | 0.800 |
| 2 | 190 | Integer Overflow or Wraparound | Base | Allowed | alternate_terms | 0.800 |
| 3 | 193 | Off-by-one Error | Base | Allowed | sparse | 0.403 |
| 4 | 122 | Heap-based Buffer Overflow | Variant | Allowed | sparse | 0.265 |
| 5 | 1284 | Improper Validation of Specified Quantity in Input | Base | Allowed | sparse | 0.247 |
| 6 | 250 | Execution with Unnecessary Privileges | Base | Allowed | dense | 0.522 |
| 7 | 128 | Wrap-around Error | Base | Allowed | graph | 0.003 |
| 8 | 131 | Incorrect Calculation of Buffer Size | Base | Allowed | sparse | 0.246 |
| 9 | 126 | Buffer Over-read | Variant | Allowed | sparse | 0.245 |
| 10 | 121 | Stack-based Buffer Overflow | Variant | Allowed | sparse | 0.241 |



# Complete CWE Specifications


## CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer
**Abstraction:** Class
**Status:** Stable

### Description
The product performs operations on a memory buffer, but it reads from or writes to a memory location outside the buffer's intended boundary. This may result in read or write operations on unexpected memory locations that could be linked to other variables, data structures, or internal program data.

### Extended Description
Not provided

### Alternative Terms
Buffer Overflow: This term has many different meanings to different audiences. From a CWE mapping perspective, this term should be avoided where possible. Some researchers, developers, and tools intend for it to mean "write past the end of a buffer," whereas others use the same term to mean "any read or write outside the boundaries of a buffer, whether before the beginning of the buffer or after the end of the buffer." Others could mean "any action after the end of a buffer, whether it is a read or write." Since the term is commonly used for exploitation and for vulnerabilities, it further confuses things.
buffer overrun: Some prominent vendors and researchers use the term "buffer overrun," but most people use "buffer overflow." See the alternate term for "buffer overflow" for context.
memory safety: Generally used for techniques that avoid weaknesses related to memory access, such as those identified by CWE-119 and its descendants. However, the term is not formal, and there is likely disagreement between practitioners as to which weaknesses are implicitly covered by the "memory safety" term.

### Relationships
ChildOf -> CWE-118
ChildOf -> CWE-20

### Mapping Guidance
**Usage:** Discouraged
**Rationale:** CWE-119 is commonly misused in low-information vulnerability reports when lower-level CWEs could be used instead, or when more details about the vulnerability are available.
**Comments:** Look at CWE-119's children and consider mapping to CWEs such as CWE-787: Out-of-bounds Write, CWE-125: Out-of-bounds Read, or others.
**Reasons:**
- Frequent Misuse


### Additional Notes
**[Applicable Platform]** 

It is possible in any programming languages without memory management support to attempt an operation outside of the bounds of a memory buffer, but the consequences will vary widely depending on the language, platform, and chip architecture.




### Observed Examples
- **CVE-2021-22991:** Incorrect URI normalization in application traffic product leads to buffer overflow, as exploited in the wild per CISA KEV.
- **CVE-2020-29557:** Buffer overflow in Wi-Fi router web interface, as exploited in the wild per CISA KEV.
- **CVE-2009-2550:** Classic stack-based buffer overflow in media player using a long entry in a playlist




## CWE-190: Integer Overflow or Wraparound
**Abstraction:** Base
**Status:** Stable

### Description
The product performs a calculation that can
         produce an integer overflow or wraparound when the logic
         assumes that the resulting value will always be larger than
         the original value. This occurs when an integer value is
         incremented to a value that is too large to store in the
         associated representation. When this occurs, the value may
         become a very small or negative number.

### Extended Description
Not provided

### Alternative Terms
Overflow: The terms "overflow" and "wraparound" are used interchangeably by some people, but they can have more precise distinctions by others. See Terminology Notes.
Wraparound: The terms "overflow" and "wraparound" are used interchangeably by some people, but they can have more precise distinctions by others. See Terminology Notes.
wrap, wrap-around, wrap around: Alternate spellings of "wraparound"

### Relationships
ChildOf -> CWE-682
ChildOf -> CWE-682
ChildOf -> CWE-20
CanPrecede -> CWE-119

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Be careful of terminology problems with "overflow," "underflow," and "wraparound" - see Terminology Notes. Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use
**Suggested Alternatives:**
- CWE-191: Integer Underflow (Wrap or Wraparound). Consider CWE-191 when the result is less than the minimum value that can be represented (sometimes called "underflows").


### Additional Notes
**[Relationship]** Integer overflows can be primary to buffer overflows when they cause less memory to be allocated than expected.

**[Terminology]** 

"Integer overflow" is sometimes used to cover several types of errors, including signedness errors, or buffer overflows that involve manipulation of integer data types instead of characters. Part of the confusion results from the fact that 0xffffffff is -1 in a signed context. Other confusion also arises because of the role that integer overflows have in chains.


A "wraparound" is a well-defined, standard behavior that follows specific rules for how to handle situations when the intended numeric value is too large or too small to be represented, as specified in standards such as C11.


"Overflow" is sometimes conflated with "wraparound" but typically indicates a non-standard or undefined behavior.


The "overflow" term is sometimes used to indicate cases where either the maximum or the minimum is exceeded, but others might only use "overflow" to indicate exceeding the maximum while using "underflow" for exceeding the minimum.


Some people use "overflow" to mean any value outside the representable range - whether greater than the maximum, or less than the minimum - but CWE uses "underflow" for cases in which the intended result is less than the minimum.


See [REF-1440] for additional explanation of the ambiguity of terminology.


**[Other]** While there may be circumstances in which the logic intentionally relies on wrapping - such as with modular arithmetic in timers or counters - it can have security consequences if the wrap is unexpected. This is especially the case if the integer overflow can be triggered using user-supplied inputs.



### Observed Examples
- **CVE-2021-43537:** Chain: in a web browser, an unsigned 64-bit integer is forcibly cast to a 32-bit integer (CWE-681) and potentially leading to an integer overflow (CWE-190). If an integer overflow occurs, this can cause heap memory corruption (CWE-122)
- **CVE-2022-21668:** Chain: Python library does not limit the resources used to process images that specify a very large number of bands (CWE-1284), leading to excessive memory consumption (CWE-789) or an integer overflow (CWE-190).
- **CVE-2022-0545:** Chain: 3D renderer has an integer overflow (CWE-190) leading to write-what-where condition (CWE-123) using a crafted image.




## CWE-193: Off-by-one Error
**Abstraction:** Base
**Status:** Draft

### Description
A product calculates or uses an incorrect maximum or minimum value that is 1 more, or 1 less, than the correct value.

### Extended Description
Not provided

### Alternative Terms
off-by-five: An "off-by-five" error was reported for sudo in 2002 (CVE-2002-0184), but that is more like a "length calculation" error.

### Relationships
ChildOf -> CWE-682
ChildOf -> CWE-682
CanPrecede -> CWE-617
CanPrecede -> CWE-170
CanPrecede -> CWE-119

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Additional Notes
**[Relationship]** This is not always a buffer overflow. For example, an off-by-one error could be a factor in a partial comparison, a read from the wrong memory location, an incorrect conditional, etc.



### Observed Examples
- **CVE-2003-0252:** Off-by-one error allows remote attackers to cause a denial of service and possibly execute arbitrary code via requests that do not contain newlines.
- **CVE-2001-1391:** Off-by-one vulnerability in driver allows users to modify kernel memory.
- **CVE-2002-0083:** Off-by-one error allows local users or remote malicious servers to gain privileges.




## CWE-122: Heap-based Buffer Overflow
**Abstraction:** Variant
**Status:** Draft

### Description
A heap overflow condition is a buffer overflow, where the buffer that can be overwritten is allocated in the heap portion of memory, generally meaning that the buffer was allocated using a routine such as malloc().

### Extended Description
Not provided

### Alternative Terms
None

### Relationships
ChildOf -> CWE-788
ChildOf -> CWE-787

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Additional Notes
**[Relationship]** Heap-based buffer overflows are usually just as dangerous as stack-based buffer overflows.



### Observed Examples
- **CVE-2021-43537:** Chain: in a web browser, an unsigned 64-bit integer is forcibly cast to a 32-bit integer (CWE-681) and potentially leading to an integer overflow (CWE-190). If an integer overflow occurs, this can cause heap memory corruption (CWE-122)
- **CVE-2007-4268:** Chain: integer signedness error (CWE-195) passes signed comparison, leading to heap overflow (CWE-122)
- **CVE-2009-2523:** Chain: product does not handle when an input string is not NULL terminated (CWE-170), leading to buffer over-read (CWE-125) or heap-based buffer overflow (CWE-122).




## CWE-1284: Improper Validation of Specified Quantity in Input
**Abstraction:** Base
**Status:** Incomplete

### Description
The product receives input that is expected to specify a quantity (such as size or length), but it does not validate or incorrectly validates that the quantity has the required properties.

### Extended Description


Specified quantities include size, length, frequency, price, rate, number of operations, time, and others. Code may rely on specified quantities to allocate resources, perform calculations, control iteration, etc. When the quantity is not properly validated, then attackers can specify malicious quantities to cause excessive resource allocation, trigger unexpected failures, enable buffer overflows, etc.


### Alternative Terms
None

### Relationships
ChildOf -> CWE-20
ChildOf -> CWE-20
CanPrecede -> CWE-789

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Additional Notes
**[Maintenance]** This entry is still under development and will continue to see updates and content improvements.



### Observed Examples
- **CVE-2022-21668:** Chain: Python library does not limit the resources used to process images that specify a very large number of bands (CWE-1284), leading to excessive memory consumption (CWE-789) or an integer overflow (CWE-190).
- **CVE-2008-1440:** lack of validation of length field leads to infinite loop
- **CVE-2008-2374:** lack of validation of string length fields allows memory consumption or buffer over-read




## CWE-250: Execution with Unnecessary Privileges
**Abstraction:** Base
**Status:** Draft

### Description
The product performs an operation at a privilege level that is higher than the minimum level required, which creates new weaknesses or amplifies the consequences of other weaknesses.

### Extended Description


New weaknesses can be exposed because running with extra privileges, such as root or Administrator, can disable the normal security checks being performed by the operating system or surrounding environment. Other pre-existing weaknesses can turn into security vulnerabilities if they occur while operating at raised privileges.


Privilege management functions can behave in some less-than-obvious ways, and they have different quirks on different platforms. These inconsistencies are particularly pronounced if you are transitioning from one non-root user to another. Signal handlers and spawned processes run at the privilege of the owning process, so if a process is running as root when a signal fires or a sub-process is executed, the signal handler or sub-process will operate with root privileges.


### Alternative Terms
None

### Relationships
ChildOf -> CWE-269
ChildOf -> CWE-657

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Additional Notes
**[Relationship]** There is a close association with CWE-653 (Insufficient Separation of Privileges). CWE-653 is about providing separate components for each privilege; CWE-250 is about ensuring that each component has the least amount of privileges possible.

**[Maintenance]** CWE-271, CWE-272, and CWE-250 are all closely related and possibly overlapping. CWE-271 is probably better suited as a category. Both CWE-272 and CWE-250 are in active use by the community. The "least privilege" phrase has multiple interpretations.

**[Maintenance]** The Taxonomy_Mappings to ISA/IEC 62443 were added in CWE 4.10, but they are still under review and might change in future CWE versions. These draft mappings were performed by members of the "Mapping CWE to 62443" subgroup of the CWE-CAPEC ICS/OT Special Interest Group (SIG), and their work is incomplete as of CWE 4.10. The mappings are included to facilitate discussion and review by the broader ICS/OT community, and they are likely to change in future CWE versions.



### Observed Examples
- **CVE-2007-4217:** FTP client program on a certain OS runs with setuid privileges and has a buffer overflow. Most clients do not need extra privileges, so an overflow is not a vulnerability for those clients.
- **CVE-2008-1877:** Program runs with privileges and calls another program with the same privileges, which allows read of arbitrary files.
- **CVE-2007-5159:** OS incorrectly installs a program with setuid privileges, allowing users to gain privileges.




## CWE-128: Wrap-around Error
**Abstraction:** Base
**Status:** Incomplete

### Description
Wrap around errors occur whenever a value is incremented past the maximum value for its type and therefore "wraps around" to a very small, negative, or undefined value.

### Extended Description
Not provided

### Alternative Terms
None

### Relationships
ChildOf -> CWE-682
CanPrecede -> CWE-119
PeerOf -> CWE-190

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Additional Notes
**[Relationship]** The relationship between overflow and wrap-around needs to be examined more closely, since several entries (including CWE-190) are closely related.






## CWE-131: Incorrect Calculation of Buffer Size
**Abstraction:** Base
**Status:** Draft

### Description
The product does not correctly calculate the size to be used when allocating a buffer, which could lead to a buffer overflow.

### Extended Description
Not provided

### Alternative Terms
None

### Relationships
ChildOf -> CWE-682
ChildOf -> CWE-682
ChildOf -> CWE-682
ChildOf -> CWE-682
CanPrecede -> CWE-119

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Additional Notes
**[Maintenance]** 

This is a broad category. Some examples include:


  - simple math errors,

  - incorrectly updating parallel counters,

  - not accounting for size differences when "transforming" one input to another format (e.g. URL canonicalization or other transformation that can generate a result that's larger than the original input, i.e. "expansion").

This level of detail is rarely available in public reports, so it is difficult to find good examples.

**[Maintenance]** 

This weakness may be a composite or a chain. It also may contain layering or perspective differences.


This issue may be associated with many different types of incorrect calculations (CWE-682), although the integer overflow (CWE-190) is probably the most prevalent. This can be primary to resource consumption problems (CWE-400), including uncontrolled memory allocation (CWE-789). However, its relationship with out-of-bounds buffer access (CWE-119) must also be considered.




### Observed Examples
- **CVE-2020-17087:** Chain: integer truncation (CWE-197) causes small buffer allocation (CWE-131) leading to out-of-bounds write (CWE-787) in kernel pool, as exploited in the wild per CISA KEV.
- **CVE-2004-1363:** substitution overflow: buffer overflow using environment variables that are expanded after the length check is performed
- **CVE-2004-0747:** substitution overflow: buffer overflow using expansion of environment variables




## CWE-126: Buffer Over-read
**Abstraction:** Variant
**Status:** Draft

### Description
The product reads from a buffer using buffer access mechanisms such as indexes or pointers that reference memory locations after the targeted buffer.

### Extended Description
This typically occurs when the pointer or its index is incremented to a position beyond the bounds of the buffer or when pointer arithmetic results in a position outside of the valid memory location to name a few. This may result in exposure of sensitive information or possibly a crash.

### Alternative Terms
None

### Relationships
ChildOf -> CWE-125
ChildOf -> CWE-788

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Additional Notes
**[Relationship]** These problems may be resultant from missing sentinel values (CWE-463) or trusting a user-influenced input length variable.



### Observed Examples
- **CVE-2022-1733:** Text editor has out-of-bounds read past end of line while indenting C code
- **CVE-2014-0160:** Chain: "Heartbleed" bug receives an inconsistent length parameter (CWE-130) enabling an out-of-bounds read (CWE-126), returning memory that could include private cryptographic keys and other sensitive data.
- **CVE-2009-2523:** Chain: product does not handle when an input string is not NULL terminated, leading to buffer over-read or heap-based buffer overflow.




## CWE-121: Stack-based Buffer Overflow
**Abstraction:** Variant
**Status:** Draft

### Description
A stack-based buffer overflow condition is a condition where the buffer being overwritten is allocated on the stack (i.e., is a local variable or, rarely, a parameter to a function).

### Extended Description
Not provided

### Alternative Terms
Stack Overflow: "Stack Overflow" is often used to mean the same thing as stack-based buffer overflow, however it is also used on occasion to mean stack exhaustion, usually a result from an excessively recursive function call. Due to the ambiguity of the term, use of stack overflow to describe either circumstance is discouraged.

### Relationships
ChildOf -> CWE-788
ChildOf -> CWE-787

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Additional Notes
**[Other]** Stack-based buffer overflows can instantiate in return address overwrites, stack pointer overwrites or frame pointer overwrites. They can also be considered function pointer overwrites, array indexer overwrites or write-what-where condition, etc.



### Observed Examples
- **CVE-2021-35395:** Stack-based buffer overflows in SFK for wifi chipset used for IoT/embedded devices, as exploited in the wild per CISA KEV.

