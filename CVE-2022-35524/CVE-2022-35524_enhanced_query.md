# Enhanced Query for CVE-2022-35524

## Vulnerability Description
WAVLINK WN572HP3, WN533A8, WN530H4, WN535G3, WN531P3 adm.cgi has no filtering on parameters wlan_signal, web_pskValue, sel_EncrypTyp, sel_Automode, wlan_bssid, wlan_ssid and wlan_channel, which leads to **command injection** in page /wizard_rep.shtml.

### Vulnerability Description Key Phrases
- **rootcause:** **no input filtering**
- **weakness:** **command injection**
- **product:** WAVLINK WN572HP3 and WN533A8 and WN530H4 and WN535G3 and WN531P3
- **component:** /wizard_rep.shtml

## CVE Reference Links Content Summary
The provided content details multiple command injection vulnerabilities in WAVLINK routers, specifically models WN572HP3, WN533A8, WN530H4, WN535G3, and WN531P3. These vulnerabilities stem from insufficient input sanitization in various CGI scripts.

Here's a breakdown of the identified issues:

**1. /wizard_router_mesh.shtml Command Injection in adm.cgi**

*   **Root Cause:**  Lack of input filtering on parameters `web_pskValue`, `wl_Method`, `wlan_ssid`, `EncrypType`, `rwan_ip`, `rwan_mask`, `rwan_gateway`, `ppp_username`, `ppp_passwd`, and `ppp_setver` in `adm.cgi`.
*   **Weaknesses:**  Unsanitized user input passed to the underlying operating system via CGI scripts.
*   **Impact:** Remote command execution on the router's operating system.
*   **Attack Vector:**  Crafting malicious POST requests with injected commands in the vulnerable parameters when setting "Router Mode" in `/wizard_router_mesh.shtml`.
*   **Required Capabilities:** Attacker must be logged into the router's admin panel and able to craft HTTP requests.

**2. /ledonoff.shtml Command Injection in adm.cgi**

*   **Root Cause:** Lack of input filtering on parameter `led_switch` in `adm.cgi`.
*   **Weaknesses:** Unsanitized user input.
*   **Impact:** Remote command execution.
*  **Attack Vector:**  Crafting malicious POST requests with injected commands in the `led_switch` parameter while toggling the LED on `/ledonoff.shtml`.
*   **Required Capabilities:** Attacker must be logged into the router's admin panel.

**3. /wan.shtml Command Injection in adm.cgi**

*   **Root Cause:**  Lack of input filtering on parameters `ppp_username`, `ppp_passwd`, `rwan_gateway`, `rwan_mask`, and `rwan_ip` in `adm.cgi`.
*   **Weaknesses:**  Unsanitized user input.
*   **Impact:** Remote command execution.
*   **Attack Vector:** Crafting malicious POST requests with injected commands in the vulnerable parameters when setting "WAN" in `/wan.shtml`.
*   **Required Capabilities:** Attacker must be logged into the router's admin panel.

**4. /wizard_rep.shtml Command Injection in adm.cgi**

*   **Root Cause:** Lack of input filtering on parameters `wlan_signal`, `web_pskValue`, `sel_EncrypTyp`, `sel_Automode`, `wlan_bssid`, `wlan_ssid`, and `wlan_channel` in `adm.cgi`.
*   **Weaknesses:** Unsanitized user input.
*   **Impact:** Remote command execution.
*  **Attack Vector:**  Crafting malicious POST requests with injected commands in the vulnerable parameters when setting "Repeater Mode" in `/wizard_rep.shtml`.
*   **Required Capabilities:** Attacker must be logged into the router's admin panel.

**5. /ledonoff.shtml Hidden Parameter "ufconf" Command Injection in api.cgi**

*   **Root Cause:** Lack of input filtering on the hidden parameter `ufconf` in `api.cgi`.
*   **Weaknesses:**  Unsanitized hidden parameter.
*   **Impact:**  Remote command execution.
*   **Attack Vector:**  Crafting malicious POST requests with injected commands in the `ufconf` parameter when visiting `/ledonoff.shtml`, modifying the URL to `/cgi-bin/api.cgi`, and adding the `ufconf` parameter.
*   **Required Capabilities:** Attacker must be logged into the router's admin panel and able to craft HTTP requests including hidden parameters.

**6. /cli_black_list.shtml Command Injection in firewall.cgi (Adding MAC)**
*   **Root Cause:**  Lack of input filtering on the `add_mac` parameter in `firewall.cgi`.
*   **Weaknesses:** Unsanitized user input.
*   **Impact:** Remote command execution.
*   **Attack Vector:** Crafting malicious POST requests with injected commands in the `add_mac` parameter while adding a new WIFI blacklist entry in `/cli_black_list.shtml`.
*    **Required Capabilities:** Attacker must be logged into the router's admin panel.

**7. /cli_black_list.shtml Command Injection in firewall.cgi (Deleting MAC)**

*   **Root Cause:** Lack of input filtering on parameters `del_mac` and `flag` in `firewall.cgi`.
*   **Weaknesses:** Unsanitized user input.
*   **Impact:** Remote command execution.
*   **Attack Vector:** Crafting malicious POST requests with injected commands in the `del_mac` and `flag` parameters while deleting a WIFI blacklist entry in `/cli_black_list.shtml`.
*   **Required Capabilities:** Attacker must be logged into the router's admin panel.

**8. /man_security.shtml Command Injection in firewall.cgi**

*   **Root Cause:** Lack of input filtering on parameters `remoteManagementEnabled`, `blockPortScanEnabled`, `pingFrmWANFilterEnabled`, and `blockSynFloodEnabled` in `firewall.cgi`.
*   **Weaknesses:** Unsanitized user input.
*   **Impact:** Remote command execution.
*   **Attack Vector:** Crafting malicious POST requests with injected commands in the vulnerable parameters when setting system firewall in `/man_security.shtml`.
*   **Required Capabilities:** Attacker must be logged into the router's admin panel.

**9. /login.shtml Command Injection in login.cgi**

*   **Root Cause:** Lack of input filtering on parameter `key` in `login.cgi`.
*   **Weaknesses:** Unsanitized user input.
*   **Impact:** Remote command execution.
*   **Attack Vector:** Crafting malicious POST requests with injected commands in the `key` parameter when submitting the login form in `/login.shtml`.
*   **Required Capabilities:**  Attacker doesn't need to be logged in, just needs access to the login page

**10. /nas_disk.shtml Command Injection in nas.cgi**

*   **Root Cause:** Lack of input filtering on parameters `User1Passwd` and `User1` in `nas.cgi`.
*  **Weaknesses:** Unsanitized user input.
*   **Impact:** Remote command execution.
*   **Attack Vector:** Crafting malicious POST requests with injected commands in the `User1Passwd` and `User1` parameters when using the NAS functionality in `/nas_disk.shtml`.
*   **Required Capabilities:** Attacker must be logged into the router's admin panel.

**11. /qos.shtml Hidden Parameters Command Injection in qos.cgi**

*   **Root Cause:** Lack of input filtering on hidden parameters `cli_list` and `cli_num` in `qos.cgi`.
*   **Weaknesses:** Unsanitized hidden parameters.
*   **Impact:** Remote command execution.
*   **Attack Vector:** Crafting malicious POST requests with injected commands in the `cli_list` and `cli_num` parameters when visiting `/qos.shtml` and manually modifying the POST request to include those parameters.
*   **Required Capabilities:** Attacker must be logged into the router's admin panel and able to craft HTTP requests including hidden parameters.

**12. /qos.shtml Command Injection in qos.cgi**

*   **Root Cause:** Lack of input filtering on parameters `qos_bandwith` and `qos_dat` in `qos.cgi`.
*  **Weaknesses:** Unsanitized user input.
*   **Impact:** Remote command execution.
*   **Attack Vector:** Crafting malicious POST requests with injected commands in the `qos_bandwith` and `qos_dat` parameters when using the QoS functionality in `/qos.shtml`.
*   **Required Capabilities:** Attacker must be logged into the router's admin panel.

**13. /wifi_multi_ssid.shtml Command Injection in wireless.cgi**

*   **Root Cause:** Lack of input filtering on parameters `hiddenSSID32g` and `SSID2G2` in `wireless.cgi`.
*   **Weaknesses:** Unsanitized user input.
*   **Impact:** Remote command execution.
*   **Attack Vector:** Crafting malicious POST requests with injected commands in the `hiddenSSID32g` and `SSID2G2` parameters when setting WIFI SSID to extend on `/wifi_multi_ssid.shtml`.
*   **Required Capabilities:** Attacker must be logged into the router's admin panel.

**14. /wifi_mesh.shtml Hidden Parameter Command Injection in wireless.cgi**

*  **Root Cause:** Lack of input filtering on parameters `mac_5g` and `Newname` in `wireless.cgi`.
*   **Weaknesses:** Unsanitized hidden parameters.
*   **Impact:** Remote command execution.
*   **Attack Vector:**  Crafting malicious POST requests with injected commands in the `mac_5g` and `Newname` parameters when visiting `/wifi_mesh.shtml` and manually modifying the POST request to include these parameters.
*   **Required Capabilities:** Attacker must be logged into the router's admin panel and able to craft HTTP requests including hidden parameters.

**15. /wifi_mesh.shtml Command Injection in wireless.cgi (Adding Extender)**

*   **Root Cause:** Lack of input filtering on parameter `macAddr` in `wireless.cgi`.
*   **Weaknesses:** Unsanitized user input.
*   **Impact:** Remote command execution.
*  **Attack Vector:** Crafting malicious POST requests with injected commands in the `macAddr` parameter when adding an extender in `/wifi_mesh.shtml`.
*   **Required Capabilities:** Attacker must be logged into the router's admin panel.

**16. /wifi_mesh.shtml Command Injection in wireless.cgi (Clicking the button)**

*   **Root Cause:** Lack of input filtering on parameters `delete_list`, `delete_al_mac`, `b_delete_list` and `b_delete_al_mac` in `wireless.cgi`.
*  **Weaknesses:** Unsanitized user input.
*   **Impact:** Remote command execution.
*   **Attack Vector:** Crafting malicious POST requests with injected commands in the `delete_list`, `delete_al_mac`, `b_delete_list` and `b_delete_al_mac` parameters when clicking a button in `/wifi_mesh.shtml`.
*   **Required Capabilities:** Attacker must be logged into the router's admin panel.

In summary, the identified vulnerabilities allow an attacker to execute arbitrary commands on the affected WAVLINK routers via multiple web interfaces and CGI scripts by injecting commands into various parameters.  The common theme across these vulnerabilities is the lack of proper input validation and sanitization. These vulnerabilities require the attacker to be able to make http requests to the router's web interface, often requiring prior login to the administrative interface. The login.shtml vulnerability can be exploited without login.

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 77 | Improper Neutralization of Special Elements used in a Command ('Command Injection') | Class | Allowed-with-Review | alternate_terms | 1.000 |
| 2 | 78 | Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection') | Base | Allowed | alternate_terms | 0.700 |
| 3 | 790 | Improper Filtering of Special Elements | Class | Allowed-with-Review | sparse | 0.639 |
| 4 | 425 | Direct Request ('Forced Browsing') | Base | Allowed | sparse | 0.129 |
| 5 | 791 | Incomplete Filtering of Special Elements | Base | Allowed | sparse | 0.115 |
| 6 | 134 | Use of Externally-Controlled Format String | Base | Allowed | dense | 0.544 |
| 7 | 184 | Incomplete List of Disallowed Inputs | Base | Allowed | graph | 0.002 |
| 8 | 138 | Improper Neutralization of Special Elements | Class | Discouraged | sparse | 0.112 |
| 9 | 96 | Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection') | Base | Allowed | sparse | 0.112 |
| 10 | 89 | Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection') | Base | Allowed | sparse | 0.111 |



# Complete CWE Specifications


## CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')
**Abstraction:** Class
**Status:** Draft

### Description
The product constructs all or part of a command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended command when it is sent to a downstream component.

### Extended Description


Many protocols and products have their own custom command language. While OS or shell command strings are frequently discovered and targeted, developers may not realize that these other command languages might also be vulnerable to attacks.


### Alternative Terms
Command injection: an attack-oriented phrase for this weakness. Note: often used when "OS command injection" (CWE-78) was intended.

### Relationships
ChildOf -> CWE-74
ChildOf -> CWE-74

### Mapping Guidance
**Usage:** Allowed-with-Review
**Rationale:** CWE-77 is often misused when OS command injection (CWE-78) was intended instead [REF-1287].
**Comments:** Ensure that the analysis focuses on the root-cause error that allows the execution of commands, as there are many weaknesses that can lead to this consequence. See Terminology Notes. If the weakness involves a command language besides OS shell invocation, then CWE-77 could be used.
**Reasons:**
- Frequent Misuse
**Suggested Alternatives:**
- CWE-78: OS Command Injection


### Additional Notes
**[Terminology]** 

The "command injection" phrase carries different meanings, either as an attack or as a technical impact. The most common usage of "command injection" refers to the more-accurate OS command injection (CWE-78), but there are many command languages.


In vulnerability-focused analysis, the phrase may refer to any situation in which the adversary can execute commands of their own choosing, i.e., the focus is on the risk and/or technical impact of exploitation. Many proof-of-concept exploits focus on the ability to execute commands and may emphasize "command injection." However, there are dozens of weaknesses that can allow execution of commands. That is, the ability to execute commands could be resultant from another weakness.


To some, "command injection" can include cases in which the functionality intentionally allows the user to specify an entire command, which is then executed. In this case, the root cause weakness might be related to missing or incorrect authorization, since an adversary should not be able to specify arbitrary commands, but some users or admins are allowed.


CWE-77 and its descendants are specifically focused on behaviors in which the product is intentionally building a command to execute, and the adversary can inject separators into the command or otherwise change the command being executed.


**[Other]** 

Command injection is a common problem with wrapper programs.




### Observed Examples
- **CVE-2022-1509:** injection of sed script syntax ("sed injection")
- **CVE-2024-5184:** API service using a large generative AI model allows direct prompt injection to leak hard-coded system prompts or execute other prompts.
- **CVE-2020-11698:** anti-spam product allows injection of SNMP commands into confiuration file




## CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')
**Abstraction:** Base
**Status:** Stable

### Description
The product constructs all or part of an OS command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended OS command when it is sent to a downstream component.

### Extended Description


This weakness can lead to a vulnerability in environments in which the attacker does not have direct access to the operating system, such as in web applications. Alternately, if the weakness occurs in a privileged program, it could allow the attacker to specify commands that normally would not be accessible, or to call alternate commands with privileges that the attacker does not have. The problem is exacerbated if the compromised process does not follow the principle of least privilege, because the attacker-controlled commands may run with special system privileges that increases the amount of damage.


There are at least two subtypes of OS command injection:


  - The application intends to execute a single, fixed program that is under its own control. It intends to use externally-supplied inputs as arguments to that program. For example, the program might use system("nslookup [HOSTNAME]") to run nslookup and allow the user to supply a HOSTNAME, which is used as an argument. Attackers cannot prevent nslookup from executing. However, if the program does not remove command separators from the HOSTNAME argument, attackers could place the separators into the arguments, which allows them to execute their own program after nslookup has finished executing.

  - The application accepts an input that it uses to fully select which program to run, as well as which commands to use. The application simply redirects this entire command to the operating system. For example, the program might use "exec([COMMAND])" to execute the [COMMAND] that was supplied by the user. If the COMMAND is under attacker control, then the attacker can execute arbitrary commands or programs. If the command is being executed using functions like exec() and CreateProcess(), the attacker might not be able to combine multiple commands together in the same line.

From a weakness standpoint, these variants represent distinct programmer errors. In the first variant, the programmer clearly intends that input from untrusted parties will be part of the arguments in the command to be executed. In the second variant, the programmer does not intend for the command to be accessible to any untrusted party, but the programmer probably has not accounted for alternate ways in which malicious attackers can provide input.

### Alternative Terms
Shell injection
Shell metacharacters
OS Command Injection

### Relationships
ChildOf -> CWE-77
ChildOf -> CWE-74
ChildOf -> CWE-77
ChildOf -> CWE-77
CanAlsoBe -> CWE-88

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Additional Notes
**[Terminology]** The "OS command injection" phrase carries different meanings to different people. For some people, it only refers to cases in which the attacker injects command separators into arguments for an application-controlled program that is being invoked. For some people, it refers to any type of attack that can allow the attacker to execute OS commands of their own choosing. This usage could include untrusted search path weaknesses (CWE-426) that cause the application to find and execute an attacker-controlled program. Further complicating the issue is the case when argument injection (CWE-88) allows alternate command-line switches or options to be inserted into the command line, such as an "-exec" switch whose purpose may be to execute the subsequent argument as a command (this -exec switch exists in the UNIX "find" command, for example). In this latter case, however, CWE-88 could be regarded as the primary weakness in a chain with CWE-78.

**[Research Gap]** More investigation is needed into the distinction between the OS command injection variants, including the role with argument injection (CWE-88). Equivalent distinctions may exist in other injection-related problems such as SQL injection.



### Observed Examples
- **CVE-2020-10987:** OS command injection in Wi-Fi router, as exploited in the wild per CISA KEV.
- **CVE-2020-10221:** Template functionality in network configuration management tool allows OS command injection, as exploited in the wild per CISA KEV.
- **CVE-2020-9054:** Chain: improper input validation (CWE-20) in username parameter, leading to OS command injection (CWE-78), as exploited in the wild per CISA KEV.




## CWE-790: Improper Filtering of Special Elements
**Abstraction:** Class
**Status:** Incomplete

### Description
The product receives data from an upstream component, but does not filter or incorrectly filters special elements before sending it to a downstream component.

### Extended Description
Not provided

### Alternative Terms
None

### Relationships
ChildOf -> CWE-138

### Mapping Guidance
**Usage:** Allowed-with-Review
**Rationale:** This CWE entry is a Class and might have Base-level children that would be more appropriate
**Comments:** Examine children of this entry to see if there is a better fit
**Reasons:**
- Abstraction






## CWE-425: Direct Request ('Forced Browsing')
**Abstraction:** Base
**Status:** Incomplete

### Description
The web application does not adequately enforce appropriate authorization on all restricted URLs, scripts, or files.

### Extended Description
Web applications susceptible to direct request attacks often make the false assumption that such resources can only be reached through a given navigation path and so only apply authorization at certain points in the path.

### Alternative Terms
forced browsing: The "forced browsing" term could be misinterpreted to include weaknesses such as CSRF or XSS, so its use is discouraged.

### Relationships
ChildOf -> CWE-862
ChildOf -> CWE-862
ChildOf -> CWE-288
ChildOf -> CWE-424
CanPrecede -> CWE-471
CanPrecede -> CWE-98

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Additional Notes
**[Relationship]** Overlaps Modification of Assumed-Immutable Data (MAID), authorization errors, container errors; often primary to other weaknesses such as XSS and SQL injection.

**[Theoretical]** "Forced browsing" is a step-based manipulation involving the omission of one or more steps, whose order is assumed to be immutable. The application does not verify that the first step was performed successfully before the second step. The consequence is typically "authentication bypass" or "path disclosure," although it can be primary to all kinds of weaknesses, especially in languages such as PHP, which allow external modification of assumed-immutable variables.



### Observed Examples
- **CVE-2022-29238:** Access-control setting in web-based document collaboration tool is not properly implemented by the code, which prevents listing hidden directories but does not prevent direct requests to files in those directories.
- **CVE-2022-23607:** Python-based HTTP library did not scope cookies to a particular domain such that "supercookies" could be sent to any domain on redirect.
- **CVE-2004-2144:** Bypass authentication via direct request.




## CWE-791: Incomplete Filtering of Special Elements
**Abstraction:** Base
**Status:** Incomplete

### Description
The product receives data from an upstream component, but does not completely filter special elements before sending it to a downstream component.

### Extended Description
Not provided

### Alternative Terms
None

### Relationships
ChildOf -> CWE-790

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use






## CWE-134: Use of Externally-Controlled Format String
**Abstraction:** Base
**Status:** Draft

### Description
The product uses a function that accepts a format string as an argument, but the format string originates from an external source.

### Extended Description


When an attacker can modify an externally-controlled format string, this can lead to buffer overflows, denial of service, or data representation problems.


It should be noted that in some circumstances, such as internationalization, the set of format strings is externally controlled by design. If the source of these format strings is trusted (e.g. only contained in library files that are only modifiable by the system administrator), then the external control might not itself pose a vulnerability.


### Alternative Terms
None

### Relationships
ChildOf -> CWE-668
ChildOf -> CWE-668
CanPrecede -> CWE-123
ChildOf -> CWE-20

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Additional Notes
**[Applicable Platform]** 

This weakness is possible in any programming language that support format strings.


**[Other]** 

While Format String vulnerabilities typically fall under the Buffer Overflow category, technically they are not overflowed buffers. The Format String vulnerability is fairly new (circa 1999) and stems from the fact that there is no realistic way for a function that takes a variable number of arguments to determine just how many arguments were passed in. The most common functions that take a variable number of arguments, including C-runtime functions, are the printf() family of calls. The Format String problem appears in a number of ways. A *printf() call without a format specifier is dangerous and can be exploited. For example, printf(input); is exploitable, while printf(y, input); is not exploitable in that context. The result of the first call, used incorrectly, allows for an attacker to be able to peek at stack memory since the input string will be used as the format specifier. The attacker can stuff the input string with format specifiers and begin reading stack values, since the remaining parameters will be pulled from the stack. Worst case, this improper use may give away enough control to allow an arbitrary value (or values in the case of an exploit program) to be written into the memory of the running program.


Frequently targeted entities are file names, process names, identifiers.


Format string problems are a classic C/C++ issue that are now rare due to the ease of discovery. One main reason format string vulnerabilities can be exploited is due to the %n operator. The %n operator will write the number of characters, which have been printed by the format string therefore far, to the memory pointed to by its argument. Through skilled creation of a format string, a malicious user may use values on the stack to create a write-what-where condition. Once this is achieved, they can execute arbitrary code. Other operators can be used as well; for example, a %9999s operator could also trigger a buffer overflow, or when used in file-formatting functions like fprintf, it can generate a much larger output than intended.


**[Research Gap]** Format string issues are under-studied for languages other than C. Memory or disk consumption, control flow or variable alteration, and data corruption may result from format string exploitation in applications written in other languages such as Perl, PHP, Python, etc.



### Observed Examples
- **CVE-2002-1825:** format string in Perl program
- **CVE-2001-0717:** format string in bad call to syslog function
- **CVE-2002-0573:** format string in bad call to syslog function




## CWE-184: Incomplete List of Disallowed Inputs
**Abstraction:** Base
**Status:** Draft

### Description
The product implements a protection mechanism that relies on a list of inputs (or properties of inputs) that are not allowed by policy or otherwise require other action to neutralize before additional processing takes place, but the list is incomplete.

### Extended Description
Not provided

### Alternative Terms
Denylist / Deny List: This is used by CWE and CAPEC instead of other commonly-used terms. Its counterpart is allowlist.
Blocklist / Block List: This is often used by security tools such as firewalls, email or web gateways, proxies, etc.
Blacklist / Black List: This term is frequently used, but usage has been declining as organizations have started to adopt other terms.

### Relationships
ChildOf -> CWE-693
ChildOf -> CWE-1023
CanPrecede -> CWE-79
CanPrecede -> CWE-78
CanPrecede -> CWE-434
CanPrecede -> CWE-98

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Additional Notes
**[Relationship]** 

Multiple interpretation errors can indirectly introduce inputs that should be disallowed. For example, a list of dangerous shell metacharacters might not include a metacharacter that only has meaning in one particular shell, not all of them; or a check for XSS manipulations might ignore an unusual construct that is supported by one web browser, but not others.




### Observed Examples
- **CVE-2024-4315:** Chain: API for text generation using Large Language Models (LLMs) does not include the "\" Windows folder separator in its denylist (CWE-184) when attempting to prevent Local File Inclusion via path traversal (CWE-22), allowing deletion of arbitrary files on Windows systems.
- **CVE-2008-2309:** product uses a denylist to identify potentially dangerous content, allowing attacker to bypass a warning
- **CVE-2005-2782:** PHP remote file inclusion in web application that filters "http" and "https" URLs, but not "ftp".




## CWE-138: Improper Neutralization of Special Elements
**Abstraction:** Class
**Status:** Draft

### Description
The product receives input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could be interpreted as control elements or syntactic markers when they are sent to a downstream component.

### Extended Description
Most languages and protocols have their own special elements such as characters and reserved words. These special elements can carry control implications. If product does not prevent external control or influence over the inclusion of such special elements, the control flow of the program may be altered from what was intended. For example, both Unix and Windows interpret the symbol < ("less than") as meaning "read input from a file".

### Alternative Terms
None

### Relationships
ChildOf -> CWE-707

### Mapping Guidance
**Usage:** Discouraged
**Rationale:** This CWE entry is a level-1 Class (i.e., a child of a Pillar). It might have lower-level children that would be more appropriate
**Comments:** Examine children of this entry to see if there is a better fit
**Reasons:**
- Abstraction


### Additional Notes
**[Relationship]** This weakness can be related to interpretation conflicts or interaction errors in intermediaries (such as proxies or application firewalls) when the intermediary's model of an endpoint does not account for protocol-specific special elements.

**[Relationship]** See this entry's children for different types of special elements that have been observed at one point or another. However, it can be difficult to find suitable CVE examples. In an attempt to be complete, CWE includes some types that do not have any associated observed example.

**[Research Gap]** This weakness is probably under-studied for proprietary or custom formats. It is likely that these issues are fairly common in applications that use their own custom format for configuration files, logs, meta-data, messaging, etc. They would only be found by accident or with a focused effort based on an understanding of the format.



### Observed Examples
- **CVE-2001-0677:** Read arbitrary files from mail client by providing a special MIME header that is internally used to store pathnames for attachments.
- **CVE-2000-0703:** Setuid program does not cleanse special escape sequence before sending data to a mail program, causing the mail program to process those sequences.
- **CVE-2003-0020:** Multi-channel issue. Terminal escape sequences not filtered from log files.




## CWE-96: Improper Neutralization of Directives in Statically Saved Code ('Static Code Injection')
**Abstraction:** Base
**Status:** Draft

### Description
The product receives input from an upstream component, but it does not neutralize or incorrectly neutralizes code syntax before inserting the input into an executable resource, such as a library, configuration file, or template.

### Extended Description
Not provided

### Alternative Terms
None

### Relationships
ChildOf -> CWE-94

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Additional Notes
**[Relationship]** "HTML injection" (see CWE-79: XSS) could be thought of as an example of this, but the code is injected and executed on the client side, not the server side. Server-Side Includes (SSI) are an example of direct static code injection.



### Observed Examples
- **CVE-2002-0495:** Perl code directly injected into CGI library file from parameters to another CGI program.
- **CVE-2005-1876:** Direct PHP code injection into supporting template file.
- **CVE-2005-1894:** Direct code injection into PHP script that can be accessed by attacker.




## CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')
**Abstraction:** Base
**Status:** Stable

### Description
The product constructs all or part of an SQL command using externally-influenced input from an upstream component, but it does not neutralize or incorrectly neutralizes special elements that could modify the intended SQL command when it is sent to a downstream component. Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data.

### Extended Description
Not provided

### Alternative Terms
SQL injection: a common attack-oriented phrase
SQLi: a common abbreviation for "SQL injection"

### Relationships
ChildOf -> CWE-943
ChildOf -> CWE-74

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Additional Notes
**[Relationship]** SQL injection can be resultant from special character mismanagement, MAID, or denylist/allowlist problems. It can be primary to authentication errors.



### Observed Examples
- **CVE-2023-32530:** SQL injection in security product dashboard using crafted certificate fields
- **CVE-2021-42258:** SQL injection in time and billing software, as exploited in the wild per CISA KEV.
- **CVE-2021-27101:** SQL injection in file-transfer system via a crafted Host header, as exploited in the wild per CISA KEV.

