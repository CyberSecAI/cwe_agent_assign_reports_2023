# Enhanced Query for CVE-2022-39812

## Vulnerability Description
Italtel NetMatch-S CI 5.2.0-20211008 allows Absolute Path Traversal under NMSCI-WebGui/SaveFileUploader. An unauthenticated user can upload files to an arbitrary path. An attacker can change the uploadDir parameter in a POST request (not possible using the GUI) to an arbitrary directory. Because the application does not check in which directory a file will be uploaded, an attacker can perform a variety of attacks that can result in unauthorized access to the server.

### Vulnerability Description Key Phrases
- **rootcause:** **absolute path traversal**
- **impact:** unauthorized access to server
- **vector:** uploadDir parameter in a POST request
- **attacker:** unauthenticated user
- **product:** Italtel NetMatch-S CI
- **version:** 5.2.0-20211008
- **component:** NMSCI-WebGui/SaveFileUploader

## CVE Reference Links Content Summary
Based on the provided content, here's a breakdown of the vulnerabilities described, including CVE-2022-39812:

**CVE-2022-39812 - Italtel NetMatch-S CI**

*   **Root Cause:** Absolute Path Traversal
*   **Weaknesses/Vulnerabilities:** The web application fails to sanitize the `uploadDir` parameter in a POST request, allowing an unauthenticated user to upload files to an arbitrary path on the server's filesystem.
*   **Impact of Exploitation:** An attacker can upload files to arbitrary locations which can lead to various attacks and may provide unauthorized access to the server.
*   **Attack Vectors:**
    *   An unauthenticated attacker sends a crafted HTTP POST request to the `/NMSCI-WebGui/SaveFileUploader` endpoint, modifying the `uploadDir` parameter.
*   **Required Attacker Capabilities/Position:** The attacker does not need any authentication. They require network access to the vulnerable application.

**CVE-2024-52949 – iptraf-ng**

*   **Root Cause:** Stack-based Buffer Overflow
*   **Weaknesses/Vulnerabilities:** The `strcpy` function in `ifaces.c` does not perform bounds checking when copying data provided through the `-C` command-line argument.
*   **Impact of Exploitation:** An attacker can overwrite the return address of a function call in the stack and achieve arbitrary code execution.
*   **Attack Vectors:**
    *   By providing a large string to the `-C` argument, the strcpy function can overflow the buffer on the stack.
*   **Required Attacker Capabilities/Position:** Attacker needs local access to execute the `iptraf-ng` program with crafted input, often with `sudo` privileges.

**CVE-2024-49351 – IBM Workload Scheduler**

*   **Root Cause:** Plaintext Storage of a Password
*   **Weaknesses/Vulnerabilities:** The connection properties panel stores the engine connection password in cleartext.
*   **Impact of Exploitation:** An authenticated remote attacker with admin privileges can access and read the connection password in cleartext, leading to unauthorized access to sensitive systems, privilege escalation, and lateral movement within the network.
*   **Attack Vectors:**
    *   An authenticated remote attacker with administrator privileges accesses the connection properties panel.
*   **Required Attacker Capabilities/Position:** Requires administrator privileges and remote access to the vulnerable application.

**CVE-2024-9329 – Eclipse Glassfish**

*   **Root Cause:** Improper Handling of Parameters
*  **Weaknesses/Vulnerabilities:** The application does not properly handle the `Host` HTTP parameter on the `/management/domain` endpoint, which allows an attacker to cause a redirect to an arbitrary URL.
*   **Impact of Exploitation:** An attacker can redirect a user to a malicious website, which could facilitate phishing scams to steal user credentials.
*   **Attack Vectors:**
    *   An unauthenticated attacker sends a crafted HTTP GET request with a malicious `Host` parameter to the `/management/domain` endpoint.
*   **Required Attacker Capabilities/Position:** Requires network access to the vulnerable application, no authentication needed.

**CVE-2024-9054 – Microchip TP4100**

*   **Root Cause:** RCE on file configuration parameter
*   **Weaknesses/Vulnerabilities:** The device doesn't correctly sanitize parameters in the configuration file.
*   **Impact of Exploitation:** An attacker can execute arbitrary bash commands on the device by uploading a crafted configuration file with malicious commands in the `secret_key` parameter.
*   **Attack Vectors:**
    *   An attacker uploads a malicious XML configuration file to the device via the web GUI to the `/config_restore` endpoint.
*   **Required Attacker Capabilities/Position:** The attacker needs access to the web GUI of the device or access to the device network. Authentication is required for the upload.

**CVE-2024-7801 – Microchip TP4100**

*   **Root Cause:** SQL Injection
*   **Weaknesses/Vulnerabilities:** The application concatenates user input in the `channelId` parameter directly into the SQL query (SQLite).
*   **Impact of Exploitation:** An unauthenticated attacker can execute arbitrary SQL queries and access sensitive information from the database, such as the SQL version and content of tables.
*   **Attack Vectors:**
    *   An unauthenticated attacker sends a crafted POST request to the `/get_chart_data` endpoint with a malicious SQL payload in the `channelId` parameter.
*   **Required Attacker Capabilities/Position:** Network access to the device; no authentication is required.

**CVE-2024-6360 – OpenText Vertica Management Console**

*   **Root Cause:** Incorrect Permission Assignment for Critical Resource
*   **Weaknesses/Vulnerabilities:** The product creates, stores, and uses hard-coded plaintext keys needed for authorization when calling protected APIs.
*   **Impact of Exploitation:** An attacker can gain unauthorized access or privileges to Vertica agent apikey.
*  **Attack Vectors:** Details are not clearly outlined in the content.
*  **Required Attacker Capabilities/Position:** Unclear based on the available content

**CVE-2024-5532 – OpenText™ Operations Agent**

*   **Root Cause:** Cross Site Scripting Stored
*  **Weaknesses/Vulnerabilities:** The application stores a malicious payload inside the `CORE_ID` configuration value, that allows an attacker to inject an arbitrary javascript code in the HTML page when a user access to specific URLs.
*   **Impact of Exploitation:** An attacker can inject arbitrary javascript code that executes when users browse to certain pages, potentially leading to theft of credentials and other malicious activities.
*   **Attack Vectors:**
    *   An attacker with permission to modify the agent configuration file can add a malicious payload within the `CORE_ID` value.
    *   Users accessing the listed endpoints would execute the malicious script.
*   **Required Attacker Capabilities/Position:** Requires the ability to modify the configuration file.

**CVE-2024-43687 – Microchip TP4100**

*   **Root Cause:** Cross-site scripting stored
*  **Weaknesses/Vulnerabilities:** The application doesn't sanitize the input for the "Custom Banner" field, which is executed by the browser when the banner page is visited.
*  **Impact of Exploitation:** An attacker can store malicious Javascript that gets executed when a user visits the banner page.
*   **Attack Vectors:**
    *  An authenticated attacker can add arbitrary Javascript code to the "Custom Banner" field via web GUI.
*   **Required Attacker Capabilities/Position:** Requires valid authentication to the web interface of the device.

**CVE-2024-43686 – Microchip TP4100**

*   **Root Cause:** Reflected XSS
*   **Weaknesses/Vulnerabilities:** The application doesn't sanitize the input for the `channelId` parameter of the `/get_chart_data` POST request, which allows to inject malicious Javascript code.
*   **Impact of Exploitation:** An attacker can inject malicious Javascript code that executes when a user makes a crafted request to `/get_chart_data`.
*   **Attack Vectors:**
    *   An attacker sends a crafted POST request to the `/get_chart_data` endpoint with a malicious Javascript payload in the `channelId` parameter.
*   **Required Attacker Capabilities/Position:** Requires network access; no authentication is required.

**CVE-2024-43685 – Microchip TP4100**

*   **Root Cause:** Improper Authentication
*   **Weaknesses/Vulnerabilities:** The device provides a new cookie `ci_session` before the login that is used in post login session.
*   **Impact of Exploitation:** An attacker can obtain and use a session cookie before the login and hijack a session, allowing access to the application without knowing the user's credentials.
*   **Attack Vectors:**
    * An attacker can either capture the `ci_session` cookie before a user login or create a cookie with a chosen value performing a request for an unauthenticated resource.
*   **Required Attacker Capabilities/Position:** Requires network access, and ability to capture or create a session cookie.

**CVE-2024-43684 – Microchip TP4100**

*   **Root Cause:** Cross-Site Request Forgery (CSRF)
*   **Weaknesses/Vulnerabilities:** The device does not implement anti-CSRF tokens to protect against CSRF attacks.
*   **Impact of Exploitation:** An attacker can trick a user into making unintentional requests to the web server by, for example, forcing a change in the displayed banner.
*   **Attack Vectors:**
    *   An attacker can create a crafted HTML page that forces a logged in user to make an unauthorized request.
*   **Required Attacker Capabilities/Position:** Needs to trick a logged-in user into interacting with a malicious link or page.

**CVE-2024-43683 – Microchip TP4100**

*   **Root Cause:** URL Redirection to Untrusted Site
*   **Weaknesses/Vulnerabilities:** The device does not validate the `Host` header field, allowing an attacker to redirect a user to a malicious website.
*   **Impact of Exploitation:** An attacker can redirect users to a malicious website to steal credentials or perform other malicious actions.
*   **Attack Vectors:**
    *   An attacker crafts an HTTP request to the device, modifying the `Host` header field to a malicious domain.
*   **Required Attacker Capabilities/Position:** Network access to the device; no authentication is required.

**CVE-2024-34399 – BMC Remedy Mid Tier**

*  **Root Cause:** Improper Authentication
*  **Weaknesses/Vulnerabilities:** An unauthenticated remote attacker is able to access any user account without using any password.
*  **Impact of Exploitation:** An attacker can access any user account without needing any credentials.
*  **Attack Vectors:**
    *  Unauthenticated remote access.
*  **Required Attacker Capabilities/Position:**  Requires remote network access.  The content specifies that this CVE is for an unsupported product.

**CVE-2024-31847 – Italtel Embrace**

*   **Root Cause:** Improper Neutralization of Input During Web Page Generation ('Stored Cross-site Scripting')
*   **Weaknesses/Vulnerabilities:** The web application doesn't sanitize user input in HTTP/GET parameters, which leads to stored XSS on the `Activity Log` page.
*   **Impact of Exploitation:** An attacker can inject arbitrary JavaScript code that is stored and executed when a user views the `Activity Log` page, potentially leading to unauthorized access or account takeover.
*   **Attack Vectors:**
    *   An attacker sends a crafted HTTP GET request with a malicious JavaScript payload within the `ActivityLog` URL path, the payload is then saved and executed for any user accessing the activity log.
*   **Required Attacker Capabilities/Position:** Network access; no authentication is required, but authentication is sufficient.

**CVE-2024-31846 – Italtel Embrace**

*   **Root Cause:** Improper Access Control
*   **Weaknesses/Vulnerabilities:** The web application does not restrict access to resources containing client data.
*   **Impact of Exploitation:** An unauthenticated attacker can view data about clients, including phone numbers and emails, without requiring any authentication.
*   **Attack Vectors:**
    *   An unauthenticated attacker sends a crafted GET request to the `/api/v1/register` endpoint,
*   **Required Attacker Capabilities/Position:** Requires network access; no authentication is required.

**CVE-2024-31845 – Italtel Embrace**

*   **Root Cause:** Improper Output Neutralization for Logs
*  **Weaknesses/Vulnerabilities:**  The web application logs the values of a GET query string parameter without sanitizing it, allowing an attacker to forge log entries.
*   **Impact of Exploitation:** An attacker can insert fake log entries that appear to originate from a different user.
*   **Attack Vectors:**
    *   An unauthenticated attacker sends a crafted HTTP GET request with a malicious value in a query string that will be used in the log.
*   **Required Attacker Capabilities/Position:** Requires network access; no authentication is required.

**CVE-2024-31844 – Italtel Embrace**

*  **Root Cause:** Generation of Error Message Containing Sensitive Information
*  **Weaknesses/Vulnerabilities:**  The server exposes server information (absolute paths) in error messages.
*  **Impact of Exploitation:** An attacker can obtain the absolute path of the application source code, which could help in further attacks.
*  **Attack Vectors:**
    *   An unauthenticated attacker sends a crafted malformed JSON in a POST request to `/api/v1/auth/login` that forces the application to generate a verbose error message.
*   **Required Attacker Capabilities/Position:** Requires network access; no authentication is required.

**CVE-2024-31843 – Italtel Embrace**

*  **Root Cause:** Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')
*  **Weaknesses/Vulnerabilities:** The application doesn't properly sanitize input parameters, which are then used to construct OS commands.
*  **Impact of Exploitation:** An authenticated user can execute arbitrary commands on the server's operating system, potentially gaining control of the server.
*  **Attack Vectors:**
    * An authenticated attacker modifies the `removeBackup` endpoint with a crafted OS command.
*  **Required Attacker Capabilities/Position:** Requires valid authentication to the web application.

**CVE-2024-31842 – Italtel Embrace**

*  **Root Cause:** Use of GET Request Method With Sensitive Query Strings
*   **Weaknesses/Vulnerabilities:** The web application includes the user access token within GET requests, making it vulnerable to exposure of the token.
*   **Impact of Exploitation:** An attacker who obtains the token can access the web application as another user.
*   **Attack Vectors:**
    *   An attacker may be able to intercept the HTTP traffic or obtain the token from browser history or other resources.
*  **Required Attacker Capabilities/Position:** Network access; user authentication is required to get the token.

**CVE-2024-31841 – Italtel Embrace**

*  **Root Cause:** Multiple Relative Path Traversal
*  **Weaknesses/Vulnerabilities:** The web application doesn't properly sanitize input data, allowing an unauthenticated attacker to read arbitrary files by manipulating the `filename` parameter in multiple endpoints.
*  **Impact of Exploitation:** An unauthenticated attacker can read arbitrary files from the server's filesystem.
*  **Attack Vectors:**
    *   An unauthenticated attacker can modify the `filename` parameter of various endpoints using path traversal sequences (e.g., `../`).
*   **Required Attacker Capabilities/Position:** Requires network access; no authentication is required.

**CVE-2024-31840 – Italtel Embrace**

*   **Root Cause:** Insufficiently Protected Credentials
*   **Weaknesses/Vulnerabilities:** The web application displays the plain text password of the email server inside the HTML code.
*  **Impact of Exploitation:** An attacker can obtain the plaintext password of the email server used by the application.
*   **Attack Vectors:**
    *   An authenticated attacker access the email server configuration page.
*   **Required Attacker Capabilities/Position:** Requires authentication to the web application.

**CVE-2024-28806 – Italtel i-MCS NFV**

*   **Root Cause:** Absolute Path Traversal
*   **Weaknesses/Vulnerabilities:** The web server doesn't sanitize the input data, which allows unauthenticated remote attackers to upload files to an arbitrary path by manipulating the `uploadDir` parameter in POST requests.
*   **Impact of Exploitation:**  An attacker can upload files to arbitrary path.
*  **Attack Vectors:**
    *   An unauthenticated attacker modifies the `uploadDir` parameter in a POST request to the `/SaveFileUploader` endpoint to specify an arbitrary path on the server.
*  **Required Attacker Capabilities/Position:** Requires network access; no authentication is required.

**CVE-2024-28805 – Italtel i-MCS NFV**

*   **Root Cause:** Improper Access Control
*   **Weaknesses/Vulnerabilities:** The web application incorrectly restricts access to resources, allowing unauthorized users to view pages and use functionalities not intended for them and perform actions like file upload without authentication.
*   **Impact of Exploitation:** Users with lower privileges can access pages and functionalities intended for higher privilege users or unauthenticated users can upload files.
*  **Attack Vectors:**
    *   Authenticated users (even with lower privileges) can access admin pages by directly specifying their URL.
    *   Unauthenticated user is able to use the file upload endpoint
*  **Required Attacker Capabilities/Position:**  Requires network access; in some cases authentication is not needed.

**CVE-2024-28804 – Italtel i-MCS NFV**

*   **Root Cause:** Improper Neutralization of Input During Web Page Generation ('Stored Cross-site Scripting')
*   **Weaknesses/Vulnerabilities:** The web application stores unsanitized user input from the `j_username` POST parameter. This results in a stored XSS vulnerability.
*  **Impact of Exploitation:** An attacker can inject Javascript into the login process to be executed by any other user browsing the page, potentially leading to unauthorized access or full account takeover.
*   **Attack Vectors:**
    *   An unauthenticated attacker sends a crafted POST request to the `/j_security_check` endpoint with a malicious Javascript payload in the `j_username` parameter.
*   **Required Attacker Capabilities/Position:** Requires network access; no authentication is required

**CVE-2024-25007 – Ericsson Network Manager**

*   **Root Cause:** Improper Neutralization of Formula Elements in a CSV File ('CSV Injection')
*   **Weaknesses/Vulnerabilities:** The application doesn't properly sanitize exported application logs, which allows an attacker to inject malicious formulas in a CSV file.
*  **Impact of Exploitation:** An attacker with administration access can use a malicious CSV file to execute arbitrary code or achieve information disclosure on a client machine opening the exported file.
*   **Attack Vectors:** Details are not clearly outlined in the content.
*   **Required Attacker Capabilities/Position:**  Requires adjacent network access and admin permissions to the application.

**CVE-2024-22063 - ZENIC-ONE ZTE R58**

*   **Root Cause:** Improper Neutralization of Formula Elements in an XLSX File ('XLSX Injection')
*   **Weaknesses/Vulnerabilities:** User-supplied information in an Excel file is not neutralized, allowing for execution of commands when opened.
*   **Impact of Exploitation:** A remote authenticated attacker can inject an arbitrary payload in the `neId` parameter, so when a user download the Excel file clicking on an infected cell execute the payload on victim's operating system.
*   **Attack Vectors:**
    *   A remote user intercepts the HTTP Request of cloning a job and inject a payload in the `neId` parameter.
    *   The payload gets triggered when a different user download the report and click on the cell.
*   **Required Attacker Capabilities/Position:** Requires valid authentication on the web application.

**CVE-2024-20906 – Oracle Integrated Lights Out Manager**

*  **Root Cause:** Improper Neutralization of Input During Web Page Generation ('Reflected Cross-site Scripting')
*  **Weaknesses/Vulnerabilities:** The application is vulnerable to reflected XSS, allowing attackers to inject arbitrary code.
*  **Impact of Exploitation:** An attacker could inject malicious scripts, leading to unauthorized access or data manipulation.
*  **Attack Vectors:**
  * Details are not clearly outlined in the content.
*  **Required Attacker Capabilities/Position:**  Requires a high privileged attacker with network access via ICMP.

**CVE-2023-7248 – OpenText Vertica Management Console**

*   **Root Cause:** Improper Input Validation
*   **Weaknesses/Vulnerabilities:** The product is vulnerable to authentication bypass via specially crafted requests.
*   **Impact of Exploitation:** An attacker can bypass the authentication mechanisms.
*   **Attack Vectors:** Details are not clearly outlined in the content.
*   **Required Attacker Capabilities/Position:** Details are not clearly outlined in the content.

**CVE-2023-50811 – Selesta Visual Access Manager**

*   **Root Cause:** Authorization Bypass Through User-Controlled Key
*   **Weaknesses/Vulnerabilities:**  A remote user authenticated as receptionist is able to modify the `computer` parameter related to the ID of a specific reception, allowing access to other receptions not assigned to them.
*   **Impact of Exploitation:** User can gain unauthorized access and control over many other receptions.
*   **Attack Vectors:**
    *   An authenticated remote user modifies the `computer` parameter related to the ID of a specific reception by POST HTTP request interception.
*   **Required Attacker Capabilities/Position:** Requires remote access and receptionist role on the web application.

**CVE-2023-49328 – Wolters Kluwer B.POINT**

*   **Root Cause:** Improper Neutralization of Argument Delimiters in a Command ('Argument Injection')
*  **Weaknesses/Vulnerabilities:** During the authentication phase, a validate system user was potentially able to carry out a remote code execution attack by exploiting a vulnerability in a server-to-server communication module.
*   **Impact of Exploitation:** An attacker can achieve remote code execution
*  **Attack Vectors:** Details are not clearly outlined in the content.
*  **Required Attacker Capabilities/Position:**  Requires a validate system user.

**CVE-2023-39909 – Ericsson Network Manager (ENM)**

*   **Root Cause:** Improper Access Control
*   **Weaknesses/Vulnerabilities:** An improper access control issue can lead to low privilege users to access the NCM application.
*   **Impact of Exploitation:** An unauthenticated user with low privileges can access the NCM application.
*   **Attack Vectors:** Details are not clearly outlined in the content.
*   **Required Attacker Capabilities/Position:** An unauthenticated users with low privilege is required.

**CVE-2023-38328 – eGroupWare**

*   **Root Cause:** Plaintext Storage of a Password ('Improper Password Storage')
*   **Weaknesses/Vulnerabilities:** The application stores the database password in cleartext.
*   **Impact of Exploitation:**  Authenticated administrators can read the database credentials in clear text.
*  **Attack Vectors:**
    *  An authenticated admin user navigates to the setup panel.
*  **Required Attacker Capabilities/Position:** Valid administrative credentials are required.

**CVE-2023-26071 – HarpaItalia Mcubo ICT**

*   **Root Cause:** Observable Response Discrepancy
*   **Weaknesses/Vulnerabilities:** The web application provides different responses to incoming requests revealing internal state information.
*   **Impact of Exploitation:** An unauthorized attacker can perform user enumeration attacks.
*  **Attack Vectors:**
    *   The attacker probes the system via the login page by providing different user names and observing the responses.
*  **Required Attacker Capabilities/Position:** Network access to the login page; no authentication required.

**CVE-2023-26062 – Nokia Web Element Manager**

*   **Root Cause:** Improper Access Control
*   **Weaknesses/Vulnerabilities:** The application allows an unprivileged user to execute administrative functions, after tampering the response after login request.
*   **Impact of Exploitation:**  An attacker can access admin's functionality with an unprivileged user.
*  **Attack Vectors:**
    * An authenticated user intercepts the login response to change their profile to one with admin privileges.
*   **Required Attacker Capabilities/Position:** Valid authentication on the web application.

**CVE-2022-47531 – Ericsson EPG**

*   **Root Cause:** Improper Privilege Management
*   **Weaknesses/Vulnerabilities:** Missing Input Validation allows authenticated users to bypass system CLI and execute commands they are not authorized to execute.
*   **Impact of Exploitation:** An attacker can execute unauthorized commands.
*  **Attack Vectors:** Details are not clearly outlined in the content.
*   **Required Attacker Capabilities/Position:** An authenticated user.

**CVE-2022-46408 – Ericsson Network Manager (ENM)**

*   **Root Cause:** Improper Neutralization of Formula Elements in a CSV File
*   **Weaknesses/Vulnerabilities:** The application allows malicious formulas to be injected into a CSV file, which could lead to remote code execution or data leakage via maliciously injected hyperlinks.
*   **Impact of Exploitation:** An attacker can inject arbitrary formulas that leads to remote code execution at client side or to data leakage via malicious hyperlinks.
*   **Attack Vectors:** Details are not clearly outlined in the content.
*   **Required Attacker Capabilities/Position:** The attacker needs admin/elevated access to exploit the vulnerability.

**CVE-2022-46407 – Ericsson Network Manager (ENM)**

*  **Root Cause:** Open Redirect
*   **Weaknesses/Vulnerabilities:** The REST endpoint “editprofile” is vulnerable to an open redirect due to improper handling of the HTTP header.
*   **Impact of Exploitation:**  An attacker can redirect the request to a domain outside of the control of the ENM.
*  **Attack Vectors:** Details are not clearly outlined in the content.
*   **Required Attacker Capabilities/Position:** Requires admin/elevated access.

**CVE-2022-45180 – LiveBox Collaboration vDesk**

*   **Root Cause:** Improper Access Control
*   **Weaknesses/Vulnerabilities:** The `/export` endpoint does not check user privileges, allowing any authenticated user to export all users’ data.
*   **Impact of Exploitation:** An authenticated attacker can export all users registered in the system.
*   **Attack Vectors:**
    *  An authenticated attacker sends an HTTP GET request to the `/export` endpoint.
*   **Required Attacker Capabilities/Position:** Requires valid authentication.

**CVE-2022-45179 – LiveBox Collaboration vDesk**

*   **Root Cause:** Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)
*  **Weaknesses/Vulnerabilities:** The application doesn't sanitize HTML code in the reminder section title, allowing an attacker to store malicious HTML, leading to XSS.
*   **Impact of Exploitation:** An attacker can corrupt the web page, create phishing sections, or redirect users to external domains.
*   **Attack Vectors:**
    *   An authenticated attacker stores malicious HTML in the `title` parameter of the `/todo/createorupdate` API and this code is then rendered to other users.
*   **Required Attacker Capabilities/Position:** Requires valid authentication.

**CVE-2022-45178 – LiveBox Collaboration vDesk**

*   **Root Cause:** Improper Access Control
*   **Weaknesses/Vulnerabilities:**  The `/api/v1/vdeskintegration/saml/user/createorupdate`, `/settings/guest-settings`, `/settings/samlusers-settings` and `/settings/users-settings` endpoints allow a low privilege user to elevate to administrator privileges and create new users.
*   **Impact of Exploitation:** An attacker logged in as a SAML user can achieve privilege escalation to an administrative role or create new users with admin roles.
*   **Attack Vectors:**
    *   An authenticated attacker (SAML User) sends a crafted HTTP request to the vulnerable endpoints.
*   **Required Attacker Capabilities/Position:** Requires valid authentication as a SAML User.

**CVE-2022-45177 – LiveBox Collaboration vDesk**

*   **Root Cause:** Observable Response Discrepancy
*   **Weaknesses/Vulnerabilities:** The application provides different responses to requests based on user existence, which allows an unauthenticated attacker to perform user enumeration attacks.
*   **Impact of Exploitation:** An unauthenticated attacker can enumerate valid users on the platform.
*   **Attack Vectors:**
    *   An unauthenticated attacker sends HTTP requests to the `/user/isenableuser`, `/sharedsearch`, or `/login` endpoint to test user presence.
*   **Required Attacker Capabilities/Position:** Requires network access; no authentication is required.

**CVE-2022-45176 – LiveBox Collaboration vDesk**

*   **Root Cause:** Improper Neutralization of Input During Web Page Generation ('Stored Cross-site Scripting')
*  **Weaknesses/Vulnerabilities:** The web application doesn't sanitize the content of files uploaded through the `vShare` functionality.
*   **Impact of Exploitation:** An attacker can store a malicious Javascript payload and share it with other users that when accessing the shared file will execute the malicious payload.
*   **Attack Vectors:**
    *   An authenticated attacker uploads a malicious file containing Javascript code through the vShare feature.
    *  Victim users executing files or accessing the resource would trigger the code execution.
*   **Required Attacker Capabilities/Position:** Requires valid authentication on the web application.

**CVE-2022-45175 – LiveBox Collaboration vDesk**

*   **Root Cause:** Insecure Direct Object Reference (Cached Files)
*   **Weaknesses/Vulnerabilities:** The web application allows access to cached files in the OnlyOffice backend of other users by guessing the file ID.
*  **Impact of Exploitation:** An attacker can access cached files of other users in the system if they know (or guess) their file ID.
*   **Attack Vectors:**
    *   An unauthenticated attacker creates a websocket and modify the ID in the request to access cached files of other users.
*  **Required Attacker Capabilities/Position:** Requires network access; no authentication is required

**CVE-2022-45174 – LiveBox Collaboration vDesk**

*   **Root Cause:** Improper Authentication (Bypass Two-Factor Authentication for SAML Users - Bad Backup Code Check)
*   **Weaknesses/Vulnerabilities:** The application does not properly check the correctness of the TOTP when using a backup code for SAML users.
*   **Impact of Exploitation:** A user can bypass the two-factor authentication by using an arbitrary string as backup code.
*  **Attack Vectors:**
    *   A SAML user can select the backup code option and enter an arbitrary string to log in.
*   **Required Attacker Capabilities/Position:**  Requires valid authentication as SAML user.

**CVE-2022-45173 – LiveBox Collaboration vDesk**

*   **Root Cause:** Improper Authentication (Bypass Two-Factor Authentication - Lack of Server-Side Validation)
*   **Weaknesses/Vulnerabilities:**  The two-factor authentication check is performed only client-side, which allows an attacker to bypass the check by modifying the server response.
*   **Impact of Exploitation:** An attacker can bypass the two-factor authentication by manipulating the server response.
*   **Attack Vectors:**
    *   The attacker intercepts the `/challenge` endpoint response and modifies it to indicate a successful TOTP check.
*   **Required Attacker Capabilities/Position:** Requires the ability to intercept and modify the server response.

**CVE-2022-45172 – LiveBox Collaboration vDesk**

*   **Root Cause:** Multiple Improper Access Control
*  **Weaknesses/Vulnerabilities:** The application is affected by flawed authentication logic.  An unauthenticated user can perform privilege escalation to administrator or steal user accounts.
*   **Impact of Exploitation:** An unauthenticated attacker can steal the accounts of other users and create new users with admin rights.
*   **Attack Vectors:**
    *   An unauthenticated user sends crafted HTTP requests to `/validateEmail`, `/user/adduser`, or `/changePasswordUser` endpoints.
*  **Required Attacker Capabilities/Position:** Requires network access; no authentication is required.

**CVE-2022-45171 – Livebox Collaboration vDESK**

*   **Root Cause:** Unrestricted Upload of File with Dangerous Type
*   **Weaknesses/Vulnerabilities:** The application has no restriction against arbitrary file upload.
*   **Impact of Exploitation:** An authenticated attacker can upload any type of file which may lead to code execution on the server.
*  **Attack Vectors:**
    *   An authenticated attacker uploads a malicious file through the vShare component.
*   **Required Attacker Capabilities/Position:** Requires valid authentication.

**CVE-2022-45170 – LiveBox Collaboration vDesk**

*  **Root Cause:** Cryptographic Issue (File Encryption API)
*  **Weaknesses/Vulnerabilities:** The application allow a malicious user to decipher a file without knowing the key set by the user.
*  **Impact of Exploitation:** A malicious user can decrypt the file of a victim without the correct key.
*   **Attack Vectors:**
    *   An attacker logs into a victim account (or has access to it), lists the files on vShare, and send an HTTP POST request to decrypt files.
*   **Required Attacker Capabilities/Position:** Requires valid authentication.

**CVE-2022-45169 – LiveBox Collaboration vDesk**

*  **Root Cause:** Redirection to Untrusted Site ('Open Redirect')
*   **Weaknesses/Vulnerabilities:** The application allows an authenticated user to send push notifications with clickable links to other users, allowing for redirection to an arbitrary external domain.
*  **Impact of Exploitation:** An authenticated attacker can redirect other users to arbitrary web sites for phishing attacks or exploiting XSS.
*   **Attack Vectors:**
    *   An authenticated attacker sends a POST request to the `/notification/createnotification` endpoint that contains an arbitrary URL.
*  **Required Attacker Capabilities/Position:** Requires valid authentication.

**CVE-2022-45168 – Livebox Collaboration vDesk**

*  **Root Cause:** Improper Authentication
*  **Weaknesses/Vulnerabilities:** The application allows a user to generate backup codes before verifying the TOTP, which allows bypassing of 2FA.
*  **Impact of Exploitation:** A malicious user can bypass the two-factor authentication.
*  **Attack Vectors:**
   *  An authenticated user generates backup codes before checking TOTP.
*  **Required Attacker Capabilities/Position:** Requires a valid session to exploit.

**CVE-2022-43675 – NOKIA NFM-T Network Element Manager**

*   **Root Cause:** Improper Neutralization of Input During Web Page Generation ('Reflected Cross-site Scripting')
*   **Weaknesses/Vulnerabilities:** The web application does not sanitize the input in multiple HTTP/GET parameters, allowing for Reflected XSS attacks.
*   **Impact of Exploitation:** An attacker can inject Javascript code into various GET parameters, leading to the execution of arbitrary code in a user's browser.
*  **Attack Vectors:**
    *   An unauthenticated attacker crafts an HTTP GET request with malicious code in various parameters such as filename, id and others.
*   **Required Attacker Capabilities/Position:** Requires network access; no authentication is required.

**CVE-2022-41763 – NOKIA AMS**

*   **Root Cause:** Improper Neutralization of Directives in Dynamically Evaluated Code
*   **Weaknesses/Vulnerabilities:** A remote user with proper authentication can inject code via debugger to the `ipAddress` variable in the `PING` function.
*  **Impact of Exploitation:** An attacker can inject code that will be executed by the server, leading to arbitrary command execution.
*   **Attack Vectors:**
     *   An authenticated attacker can inject code in the PING function by modifying the `ipAddress` variable through the debugger.
*   **Required Attacker Capabilities/Position:** Requires valid authentication to the application.

**CVE-2022-41762 – NOKIA NFM-T Network Element Manager**

*   **Root Cause:** Improper Neutralization of Input During Web Page Generation ('Reflected Cross-site Scripting')
*   **Weaknesses/Vulnerabilities:**  The application does not sanitize the parameters sent as

## Retriever Results

### Top Combined Results

| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |
|------|--------|------|-------------|-------|------------|-------------------|
| 1 | 22 | Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') | Base | Allowed | alternate_terms | 0.800 |
| 2 | 36 | Absolute Path Traversal | Base | Allowed | sparse | 0.605 |
| 3 | 23 | Relative Path Traversal | Base | Allowed | sparse | 0.516 |
| 4 | 434 | Unrestricted Upload of File with Dangerous Type | Base | Allowed | sparse | 0.496 |
| 5 | 73 | External Control of File Name or Path | Base | Allowed | sparse | 0.485 |
| 6 | 25 | Path Traversal: '/../filedir' | Variant | Allowed | dense | 0.585 |
| 7 | 59 | Improper Link Resolution Before File Access ('Link Following') | Base | Allowed | graph | 0.002 |
| 8 | 306 | Missing Authentication for Critical Function | Base | Allowed | sparse | 0.452 |
| 9 | 24 | Path Traversal: '../filedir' | Variant | Allowed | sparse | 0.449 |
| 10 | 639 | Authorization Bypass Through User-Controlled Key | Base | Allowed | sparse | 0.447 |



# Complete CWE Specifications


## CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')
**Abstraction:** Base
**Status:** Stable

### Description
The product uses external input to construct a pathname that is intended to identify a file or directory that is located underneath a restricted parent directory, but the product does not properly neutralize special elements within the pathname that can cause the pathname to resolve to a location that is outside of the restricted directory.

### Extended Description


Many file operations are intended to take place within a restricted directory. By using special elements such as ".." and "/" separators, attackers can escape outside of the restricted location to access files or directories that are elsewhere on the system. One of the most common special elements is the "../" sequence, which in most modern operating systems is interpreted as the parent directory of the current location. This is referred to as relative path traversal. Path traversal also covers the use of absolute pathnames such as "/usr/local/bin" to access unexpected files. This is referred to as absolute path traversal.


### Alternative Terms
Directory traversal
Path traversal: "Path traversal" is preferred over "directory traversal," but both terms are attack-focused.

### Relationships
ChildOf -> CWE-706
ChildOf -> CWE-706
ChildOf -> CWE-668

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Additional Notes
**[Other]** In many programming languages, the injection of a null byte (the 0 or NUL) may allow an attacker to truncate a generated filename to apply to a wider range of files. For example, the product may add ".txt" to any pathname, thus limiting the attacker to text files, but a null injection may effectively remove this restriction.

**[Relationship]** Pathname equivalence can be regarded as a type of canonicalization error.

**[Relationship]** Some pathname equivalence issues are not directly related to directory traversal, rather are used to bypass security-relevant checks for whether a file/directory can be accessed by the attacker (e.g. a trailing "/" on a filename could bypass access rules that don't expect a trailing /, causing a server to provide the file when it normally would not).

**[Terminology]** 

Like other weaknesses, terminology is often based on the types of manipulations used, instead of the underlying weaknesses. Some people use "directory traversal" only to refer to the injection of ".." and equivalent sequences whose specific meaning is to traverse directories.


Other variants like "absolute pathname" and "drive letter" have the *effect* of directory traversal, but some people may not call it such, since it doesn't involve ".." or equivalent.


**[Research Gap]** Many variants of path traversal attacks are probably under-studied with respect to root cause. CWE-790 and CWE-182 begin to cover part of this gap.

**[Research Gap]** 

Incomplete diagnosis or reporting of vulnerabilities can make it difficult to know which variant is affected. For example, a researcher might say that "..\" is vulnerable, but not test "../" which may also be vulnerable.


Any combination of directory separators ("/", "\", etc.) and numbers of "." (e.g. "....") can produce unique variants; for example, the "//../" variant is not listed (CVE-2004-0325). See this entry's children and lower-level descendants.




### Observed Examples
- **CVE-2024-37032:** Large language model (LLM) management tool does not validate the format of a digest value (CWE-1287) from a private, untrusted model registry, enabling relative path traversal (CWE-23), a.k.a. Probllama
- **CVE-2024-4315:** Chain: API for text generation using Large Language Models (LLMs) does not include the "\" Windows folder separator in its denylist (CWE-184) when attempting to prevent Local File Inclusion via path traversal (CWE-22), allowing deletion of arbitrary files on Windows systems.
- **CVE-2022-45918:** Chain: a learning management tool debugger uses external input to locate previous session logs (CWE-73) and does not properly validate the given path (CWE-20), allowing for filesystem path traversal using "../" sequences (CWE-24)




## CWE-36: Absolute Path Traversal
**Abstraction:** Base
**Status:** Draft

### Description
The product uses external input to construct a pathname that should be within a restricted directory, but it does not properly neutralize absolute path sequences such as "/abs/path" that can resolve to a location that is outside of that directory.

### Extended Description
This allows attackers to traverse the file system to access files or directories that are outside of the restricted directory.

### Alternative Terms
None

### Relationships
ChildOf -> CWE-22
ChildOf -> CWE-22
ChildOf -> CWE-22

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use



### Observed Examples
- **CVE-2022-31503:** Python package constructs filenames using an unsafe os.path.join call on untrusted input, allowing absolute path traversal because os.path.join resets the pathname to an absolute path that is specified as part of the input.
- **CVE-2002-1345:** Multiple FTP clients write arbitrary files via absolute paths in server responses
- **CVE-2001-1269:** ZIP file extractor allows full path




## CWE-23: Relative Path Traversal
**Abstraction:** Base
**Status:** Draft

### Description
The product uses external input to construct a pathname that should be within a restricted directory, but it does not properly neutralize sequences such as ".." that can resolve to a location that is outside of that directory.

### Extended Description
This allows attackers to traverse the file system to access files or directories that are outside of the restricted directory.

### Alternative Terms
Zip Slip: "Zip slip" is an attack that uses file archives (e.g., ZIP, tar, rar, etc.) that contain filenames with path traversal sequences that cause the files to be written outside of the directory under which the archive is expected to be extracted [REF-1282]. It is most commonly used for relative path traversal (CWE-23) and link following (CWE-59).

### Relationships
ChildOf -> CWE-22
ChildOf -> CWE-22
ChildOf -> CWE-22

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use



### Observed Examples
- **CVE-2024-37032:** Large language model (LLM) management tool does not validate the format of a digest value (CWE-1287) from a private, untrusted model registry, enabling relative path traversal (CWE-23), a.k.a. Probllama
- **CVE-2022-45918:** Chain: a learning management tool debugger uses external input to locate previous session logs (CWE-73) and does not properly validate the given path (CWE-20), allowing for filesystem path traversal using "../" sequences (CWE-24)
- **CVE-2019-20916:** Python package manager does not correctly restrict the filename specified in a Content-Disposition header, allowing arbitrary file read using path traversal sequences such as "../"




## CWE-434: Unrestricted Upload of File with Dangerous Type
**Abstraction:** Base
**Status:** Draft

### Description
The product allows the upload or transfer of dangerous file types that are automatically processed within its environment.

### Extended Description
Not provided

### Alternative Terms
Unrestricted File Upload: Used in vulnerability databases and elsewhere, but it is insufficiently precise. The phrase could be interpreted as the lack of restrictions on the size or number of uploaded files, which is a resource consumption issue.

### Relationships
ChildOf -> CWE-669
ChildOf -> CWE-669
PeerOf -> CWE-351
PeerOf -> CWE-436
PeerOf -> CWE-430

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Additional Notes
**[Relationship]** 

This can have a chaining relationship with incomplete denylist / permissive allowlist errors when the product tries, but fails, to properly limit which types of files are allowed (CWE-183, CWE-184).


This can also overlap multiple interpretation errors for intermediaries, e.g. anti-virus products that do not remove or quarantine attachments with certain file extensions that can be processed by client systems.




### Observed Examples
- **CVE-2023-5227:** PHP-based FAQ management app does not check the MIME type for uploaded images
- **CVE-2001-0901:** Web-based mail product stores ".shtml" attachments that could contain SSI
- **CVE-2002-1841:** PHP upload does not restrict file types




## CWE-73: External Control of File Name or Path
**Abstraction:** Base
**Status:** Draft

### Description
The product allows user input to control or influence paths or file names that are used in filesystem operations.

### Extended Description


This could allow an attacker to access or modify system files or other files that are critical to the application.


Path manipulation errors occur when the following two conditions are met:

```
		1. An attacker can specify a path used in an operation on the filesystem.
		2. By specifying the resource, the attacker gains a capability that would not otherwise be permitted.
```
For example, the program may give the attacker the ability to overwrite the specified file or run with a configuration controlled by the attacker.

### Alternative Terms
None

### Relationships
ChildOf -> CWE-642
ChildOf -> CWE-610
ChildOf -> CWE-20
CanPrecede -> CWE-22
CanPrecede -> CWE-41
CanPrecede -> CWE-98
CanPrecede -> CWE-434
CanPrecede -> CWE-59

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Additional Notes
**[Maintenance]** CWE-114 is a Class, but it is listed a child of CWE-73 in view 1000. This suggests some abstraction problems that should be resolved in future versions.

**[Relationship]** 

The external control of filenames can be the primary link in chains with other file-related weaknesses, as seen in the CanPrecede relationships. This is because software systems use files for many different purposes: to execute programs, load code libraries, to store application data, to store configuration settings, record temporary data, act as signals or semaphores to other processes, etc.


However, those weaknesses do not always require external control. For example, link-following weaknesses (CWE-59) often involve pathnames that are not controllable by the attacker at all.


The external control can be resultant from other issues. For example, in PHP applications, the register_globals setting can allow an attacker to modify variables that the programmer thought were immutable, enabling file inclusion (CWE-98) and path traversal (CWE-22). Operating with excessive privileges (CWE-250) might allow an attacker to specify an input filename that is not directly readable by the attacker, but is accessible to the privileged program. A buffer overflow (CWE-119) might give an attacker control over nearby memory locations that are related to pathnames, but were not directly modifiable by the attacker.




### Observed Examples
- **CVE-2022-45918:** Chain: a learning management tool debugger uses external input to locate previous session logs (CWE-73) and does not properly validate the given path (CWE-20), allowing for filesystem path traversal using "../" sequences (CWE-24)
- **CVE-2008-5748:** Chain: external control of values for user's desired language and theme enables path traversal.
- **CVE-2008-5764:** Chain: external control of user's target language enables remote file inclusion.




## CWE-25: Path Traversal: '/../filedir'
**Abstraction:** Variant
**Status:** Incomplete

### Description
The product uses external input to construct a pathname that should be within a restricted directory, but it does not properly neutralize "/../" sequences that can resolve to a location that is outside of that directory.

### Extended Description


This allows attackers to traverse the file system to access files or directories that are outside of the restricted directory.


Sometimes a program checks for "../" at the beginning of the input, so a "/../" can bypass that check.


### Alternative Terms
None

### Relationships
ChildOf -> CWE-23

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use



### Observed Examples
- **CVE-2022-20775:** A cloud management tool allows attackers to bypass the restricted shell using path traversal sequences like "/../" in the USER environment variable.




## CWE-59: Improper Link Resolution Before File Access ('Link Following')
**Abstraction:** Base
**Status:** Draft

### Description
The product attempts to access a file based on the filename, but it does not properly prevent that filename from identifying a link or shortcut that resolves to an unintended resource.

### Extended Description
Not provided

### Alternative Terms
insecure temporary file: Some people use the phrase "insecure temporary file" when referring to a link following weakness, but other weaknesses can produce insecure temporary files without any symlink involvement at all.
Zip Slip: "Zip slip" is an attack that uses file archives (e.g., ZIP, tar, rar, etc.) that contain filenames with path traversal sequences that cause the files to be written outside of the directory under which the archive is expected to be extracted [REF-1282]. It is most commonly used for relative path traversal (CWE-23) and link following (CWE-59).

### Relationships
ChildOf -> CWE-706
ChildOf -> CWE-706

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use


### Additional Notes
**[Theoretical]** 

Link following vulnerabilities are Multi-factor Vulnerabilities (MFV). They are the combination of multiple elements: file or directory permissions, filename predictability, race conditions, and in some cases, a design limitation in which there is no mechanism for performing atomic file creation operations.


Some potential factors are race conditions, permissions, and predictability.




### Observed Examples
- **CVE-1999-1386:** Some versions of Perl follow symbolic links when running with the -e option, which allows local users to overwrite arbitrary files via a symlink attack.
- **CVE-2000-1178:** Text editor follows symbolic links when creating a rescue copy during an abnormal exit, which allows local users to overwrite the files of other users.
- **CVE-2004-0217:** Antivirus update allows local users to create or append to arbitrary files via a symlink attack on a logfile.




## CWE-306: Missing Authentication for Critical Function
**Abstraction:** Base
**Status:** Draft

### Description
The product does not perform any authentication for functionality that requires a provable user identity or consumes a significant amount of resources.

### Extended Description
Not provided

### Alternative Terms
None

### Relationships
ChildOf -> CWE-287
ChildOf -> CWE-287

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use



### Observed Examples
- **CVE-2022-31260:** Chain: a digital asset management program has an undisclosed backdoor in the legacy version of a PHP script (CWE-912) that could allow an unauthenticated user to export metadata (CWE-306)
- **CVE-2022-29951:** TCP-based protocol in Programmable Logic Controller (PLC) has no authentication.
- **CVE-2022-29952:** Condition Monitor firmware uses a protocol that does not require authentication.




## CWE-24: Path Traversal: '../filedir'
**Abstraction:** Variant
**Status:** Incomplete

### Description
The product uses external input to construct a pathname that should be within a restricted directory, but it does not properly neutralize "../" sequences that can resolve to a location that is outside of that directory.

### Extended Description


This allows attackers to traverse the file system to access files or directories that are outside of the restricted directory.


The "../" manipulation is the canonical manipulation for operating systems that use "/" as directory separators, such as UNIX- and Linux-based systems. In some cases, it is useful for bypassing protection schemes in environments for which "/" is supported but not the primary separator, such as Windows, which uses "\" but can also accept "/".


### Alternative Terms
None

### Relationships
ChildOf -> CWE-23

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use



### Observed Examples
- **CVE-2022-45918:** Chain: a learning management tool debugger uses external input to locate previous session logs (CWE-73) and does not properly validate the given path (CWE-20), allowing for filesystem path traversal using "../" sequences (CWE-24)




## CWE-639: Authorization Bypass Through User-Controlled Key
**Abstraction:** Base
**Status:** Incomplete

### Description
The system's authorization functionality does not prevent one user from gaining access to another user's data or record by modifying the key value identifying the data.

### Extended Description


Retrieval of a user record occurs in the system based on some key value that is under user control. The key would typically identify a user-related record stored in the system and would be used to lookup that record for presentation to the user. It is likely that an attacker would have to be an authenticated user in the system. However, the authorization process would not properly check the data access operation to ensure that the authenticated user performing the operation has sufficient entitlements to perform the requested data access, hence bypassing any other authorization checks present in the system.


For example, attackers can look at places where user specific data is retrieved (e.g. search screens) and determine whether the key for the item being looked up is controllable externally. The key may be a hidden field in the HTML form field, might be passed as a URL parameter or as an unencrypted cookie variable, then in each of these cases it will be possible to tamper with the key value.


One manifestation of this weakness is when a system uses sequential or otherwise easily-guessable session IDs that would allow one user to easily switch to another user's session and read/modify their data.


### Alternative Terms
Insecure Direct Object Reference / IDOR: The "Insecure Direct Object Reference" term, as described in the OWASP Top Ten, is broader than this CWE because it also covers path traversal (CWE-22). Within the context of vulnerability theory, there is a similarity between the OWASP concept and CWE-706: Use of Incorrectly-Resolved Name or Reference.
Broken Object Level Authorization / BOLA: BOLA is used in the 2019 OWASP API Security Top 10 and is said to be the same as IDOR.
Horizontal Authorization: "Horizontal Authorization" is used to describe situations in which two users have the same privilege level, but must be prevented from accessing each other's resources. This is fairly common when using key-based access to resources in a multi-user context.

### Relationships
ChildOf -> CWE-863
ChildOf -> CWE-863
ChildOf -> CWE-284

### Mapping Guidance
**Usage:** Allowed
**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.
**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.
**Reasons:**
- Acceptable-Use



### Observed Examples
- **CVE-2021-36539:** An educational application does not appropriately restrict file IDs to a particular user. The attacker can brute-force guess IDs, indicating IDOR.

