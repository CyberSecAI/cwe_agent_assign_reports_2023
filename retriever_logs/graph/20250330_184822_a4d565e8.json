{
  "retriever": "graph",
  "query": "## Vulnerability Description\nA vulnerability in the handling of RSA keys on devices running Cisco Adaptive Security Appliance (ASA) Software and Cisco Firepower Threat Defense (FTD) Software could allow an unauthenticated, remote attacker to retrieve an RSA private key. This vulnerability is due to a **logic error when the RSA key is stored in memory on a hardware platform that performs hardware-based cryptography**. An attacker could exploit this vulnerability by using a Lenstra side-channel attack against the targeted device. A successful exploit could allow the attacker to retrieve the RSA private key. The following conditions may be observed on an affected device This vulnerability will apply to approximately 5 percent of the RSA keys on a device that is running a vulnerable release of Cisco ASA Software or Cisco FTD Software not all RSA keys are expected to be affected due to mathematical calculations applied to the RSA key. The RSA key could be valid but have specific characteristics that make it vulnerable to the potential leak of the RSA private key. If an attacker obtains the RSA private key, they could use the key to impersonate a device that is running Cisco ASA Software or Cisco FTD Software or to decrypt the device traffic. See the Indicators of Compromise section for more information on the detection of this type of RSA key. The RSA key could be malformed and invalid. A malformed RSA key is not functional, and a TLS client connection to a device that is running Cisco ASA Software or Cisco FTD Software that uses the malformed RSA key will result in a TLS signature failure, which means a vulnerable software release created an invalid RSA signature that failed verification. If an attacker obtains the RSA private key, they could use the key to impersonate a device that is running Cisco ASA Software or Cisco FTD Software or to decrypt the device traffic.\n\n### Vulnerability Description Key Phrases\n- **rootcause:** **logic error when the RSA key is stored in memory on a hardware platform that performs hardware-based cryptography**\n- **impact:** retrieve an RSA private key\n- **vector:** Lenstra side-channel attack\n- **attacker:** unauthenticated remote attacker\n- **product:** Cisco Adaptive Security Appliance (ASA) Software and Cisco Firepower Threat Defense (FTD) Software\n\n## CVE Reference Links Content Summary\n```\n{\n  \"guidelines\": [\n    \"First verify if the content relates to the CVE specified based on the official description\",\n    \"If the content does not relate to this CVE, respond with \\\"UNRELATED\\\"\",\n    \"If no useful vulnerability information is found, respond with \\\"NOINFO\\\"\",\n    \"For relevant content, extract:\",\n    \"   - Root cause of vulnerability\",\n    \"   - Weaknesses/vulnerabilities present\",\n    \"   - Impact of exploitation\",\n    \"   - Attack vectors\",\n    \"   - Required attacker capabilities/position\",\n    \"Additional instructions:\",\n    \"- Preserve original technical details and descriptions\",\n    \"- Remove unrelated content\",\n    \"- Translate non-English content to English\",\n    \"- Note if the content provides more detail than the official CVE description\"\n  ],\n  \"relevant_content\": [\n    {\n      \"source\": \"sec.cloudapps.cisco.com_21caad6d_20250108_151400.html\",\n      \"vulnerability\": {\n        \"root_cause\": \"A logic error occurs when the RSA key is stored in memory on hardware platforms that perform hardware-based cryptography, leading to a potential vulnerability to a Lenstra side-channel attack.\",\n        \"weaknesses\": [\n          \"RSA private key can be retrieved due to logic error during storage on vulnerable hardware platforms.\",\n          \"Vulnerable RSA keys can be malformed or susceptible to private key leakage.\"\n        ],\n        \"impact\": \"An unauthenticated, remote attacker could potentially retrieve the RSA private key. The attacker could then use the key to impersonate a device running Cisco ASA or FTD software or decrypt the device traffic.\",\n        \"attack_vector\": \"The vulnerability can be exploited using a Lenstra side-channel attack against the targeted device.\",\n        \"attacker_capabilities\": \"An unauthenticated, remote attacker is required to conduct the Lenstra side-channel attack.\"\n      },\n      \"additional_details\": \"The document provides more granular details about the affected products and software releases, how to detect vulnerable RSA keys using a Cisco off-box detection script, syslog messages, error counters, device boot warnings and debug commands. It also lists the Cisco ASA and FTD Software features that are potentially vulnerable if a malformed or susceptible RSA key is associated with that feature's configuration. It also provides information about how to obtain fixed software\"\n    },\n    {\n      \"source\": \"github.com_de14dd7a_20250108_151354.html\",\n       \"vulnerability\": {\n          \"root_cause\": \"A logic error when the RSA key is stored in memory on a hardware platform that performs hardware-based cryptography, making it vulnerable to a Lenstra side-channel attack.\",\n          \"weaknesses\": [\n            \"RSA keys can be malformed and invalid.\",\n            \"RSA keys can have specific characteristics that make them vulnerable to a private key leak.\"\n           ],\n          \"impact\": \"An unauthenticated, remote attacker to retrieve the RSA private key. The key could be used to impersonate a Cisco ASA or FTD device.\",\n         \"attack_vector\": \"A Lenstra side-channel attack.\",\n          \"attacker_capabilities\":\"An unauthenticated, remote attacker.\"\n        },\n       \"additional_details\": \"This content provides information about a python script that can be used to check RSA keys exported from ASA or FTD devices for susceptibility to CVE-2022-20866, and includes details on system requirements, supported platforms, key export procedures, and examples of how to run the script.\"\n    },\n    {\n      \"source\": \"tools.cisco.com_806c2eaf_20250108_115033.html\",\n      \"vulnerability\": {\n        \"root_cause\": \"A logic error during RSA key storage in memory on hardware platforms that perform hardware-based cryptography which is exploited through a Lenstra side-channel attack.\",\n         \"weaknesses\": [\n          \"Vulnerable to Lenstra side-channel attack due to logic error during RSA key storage.\",\n          \"RSA keys may be malformed or susceptible to a private key leak.\"\n        ],\n        \"impact\": \"An unauthenticated remote attacker could retrieve the RSA private key, which can be used to impersonate devices or decrypt traffic.\",\n        \"attack_vector\": \"Lenstra side-channel attack.\",\n        \"attacker_capabilities\": \"An unauthenticated, remote attacker.\"\n      },\n      \"additional_details\": \"This content provides similar information to sec.cloudapps.cisco.com_21caad6d_20250108_151400.html but in a different format. It outlines how to determine if RSA keys are malformed or susceptible, and how to mitigate the vulnerability and provides fix information. It provides indicators of compromise on fixed releases only including syslogs, error counters and debug commands, and describes what can be observed during device boot.\"\n    },\n     {\n      \"source\": \"sec.cloudapps.cisco.com_4e190a99_20250108_151352.html\",\n       \"vulnerability\": {\n          \"root_cause\": \"A logic error when the RSA key is stored in memory on a hardware platform that performs hardware-based cryptography, leading to potential exploit via Lenstra side-channel attack.\",\n          \"weaknesses\": [\n           \"RSA keys can be malformed and invalid.\",\n           \"RSA keys can be susceptible to private key leaks.\"\n          ],\n          \"impact\": \"An unauthenticated, remote attacker can retrieve RSA private keys which could be used to impersonate affected Cisco ASA/FTD devices or to decrypt traffic.\",\n           \"attack_vector\":\"Lenstra side-channel attack.\",\n          \"attacker_capabilities\":\"An unauthenticated, remote attacker.\"\n       },\n        \"additional_details\": \"This content is in the form of a CSAF document, providing a machine-readable description of the vulnerability, including detailed information about affected products, indicators of compromise, how to check and remediate vulnerable RSA keys, and fix information.\"\n     }\n  ],\n  \"unrelated_content\": [\n    \"sec.cloudapps.cisco.com_f89a007b_20250108_151353.html\",\n    \"sec.cloudapps.cisco.com_2a2ebb74_20250108_151356.html\",\n    \"www.cisco.com_32921cb8_20250108_151353.html\",\n    \"sec.cloudapps.cisco.com_fa0c3199_20250108_151352.html\",\n    \"sec.cloudapps.cisco.com_31e1ccf5_20250108_151356.html\",\n    \"www.cisco.com_1c1a8903_20250108_151356.html\",\n     \"infoscience.epfl.ch_1daecdec_20250108_151359.html\",\n     \"sec.cloudapps.cisco.com_6b53f843_20250108_151357.html\"\n  ]\n}\n```\n\n## Retriever Results\n\n### Top Combined Results\n\n| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |\n|------|--------|------|-------------|-------|------------|-------------------|\n| 1 | 203 | Observable Discrepancy | Base | Allowed | sparse | 3.145 |\n| 2 | 327 | Use of a Broken or Risky Cryptographic Algorithm | Class | Allowed-with-Review | sparse | 2.124 |\n| 3 | 321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | sparse | 2.030 |\n| 4 | 1240 | Use of a Cryptographic Primitive with a Risky Implementation | Base | Allowed | sparse | 2.028 |\n| 5 | 208 | Observable Timing Discrepancy | Base | Allowed | sparse | 2.025 |\n| 6 | 780 | Use of RSA Algorithm without OAEP | Variant | Allowed | dense | 0.561 |\n| 7 | 385 | Covert Timing Channel | Base | Allowed | graph | 0.002 |\n| 8 | 799 | Improper Control of Interaction Frequency | Class | Allowed-with-Review | sparse | 2.013 |\n| 9 | 617 | Reachable Assertion | Base | Allowed | sparse | 1.961 |\n| 10 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 1.904 |\n\n\n\n# Complete CWE Specifications\n\n\n## CWE-203: Observable Discrepancy\n**Abstraction:** Base\n**Status:** Incomplete\n\n### Description\nThe product behaves differently or sends different responses under different circumstances in a way that is observable to an unauthorized actor, which exposes security-relevant information about the state of the product, such as whether a particular operation was successful or not.\n\n### Extended Description\nDiscrepancies can take many forms, and variations may be detectable in timing, control flow, communications such as replies or requests, or general behavior. These discrepancies can reveal information about the product's operation or internal state to an unauthorized actor. In some cases, discrepancies can be used by attackers to form a side channel.\n\n### Alternative Terms\nSide Channel Attack: Observable Discrepancies are at the root of side channel attacks.\n\n### Relationships\nChildOf -> CWE-200\nChildOf -> CWE-200\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n\n### Observed Examples\n- **CVE-2020-8695:** Observable discrepancy in the RAPL interface for some Intel processors allows information disclosure.\n- **CVE-2019-14353:** Crypto hardware wallet's power consumption relates to total number of pixels illuminated, creating a side channel in the USB connection that allows attackers to determine secrets displayed such as PIN numbers and passwords\n- **CVE-2019-10071:** Java-oriented framework compares HMAC signatures using String.equals() instead of a constant-time algorithm, causing timing discrepancies\n\n\n\n\n## CWE-327: Use of a Broken or Risky Cryptographic Algorithm\n**Abstraction:** Class\n**Status:** Draft\n\n### Description\nThe product uses a broken or risky cryptographic algorithm or protocol.\n\n### Extended Description\n\n\nCryptographic algorithms are the methods by which data is scrambled to prevent observation or influence by unauthorized actors. Insecure cryptography can be exploited to expose sensitive information, modify data in unexpected ways, spoof identities of other users or devices, or other impacts.\n\n\nIt is very difficult to produce a secure algorithm, and even high-profile algorithms by accomplished cryptographic experts have been broken. Well-known techniques exist to break or weaken various kinds of cryptography. Accordingly, there are a small number of well-understood and heavily studied algorithms that should be used by most products. Using a non-standard or known-insecure algorithm is dangerous because a determined adversary may be able to break the algorithm and compromise whatever data has been protected.\n\n\nSince the state of cryptography advances so rapidly, it is common for an algorithm to be considered \"unsafe\" even if it was once thought to be strong. This can happen when new attacks are discovered, or if computing power increases so much that the cryptographic algorithm no longer provides the amount of protection that was originally thought.\n\n\nFor a number of reasons, this weakness is even more challenging to manage with hardware deployment of cryptographic algorithms as opposed to software implementation. First, if a flaw is discovered with hardware-implemented cryptography, the flaw cannot be fixed in most cases without a recall of the product, because hardware is not easily replaceable like software. Second, because the hardware product is expected to work for years, the adversary's computing power will only increase over time.\n\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-693\nPeerOf -> CWE-311\n\n### Mapping Guidance\n**Usage:** Allowed-with-Review\n**Rationale:** This CWE entry is a Class and might have Base-level children that would be more appropriate\n**Comments:** Examine children of this entry to see if there is a better fit\n**Reasons:**\n- Abstraction\n\n\n### Additional Notes\n**[Maintenance]** Since CWE 4.4, various cryptography-related entries, including CWE-327 and CWE-1240, have been slated for extensive research, analysis, and community consultation to define consistent terminology, improve relationships, and reduce overlap or duplication. As of CWE 4.6, this work is still ongoing.\n\n**[Maintenance]** The Taxonomy_Mappings to ISA/IEC 62443 were added in CWE 4.10, but they are still under review and might change in future CWE versions. These draft mappings were performed by members of the \"Mapping CWE to 62443\" subgroup of the CWE-CAPEC ICS/OT Special Interest Group (SIG), and their work is incomplete as of CWE 4.10. The mappings are included to facilitate discussion and review by the broader ICS/OT community, and they are likely to change in future CWE versions.\n\n\n\n### Observed Examples\n- **CVE-2022-30273:** SCADA-based protocol supports a legacy encryption mode that uses Tiny Encryption Algorithm (TEA) in ECB mode, which leaks patterns in messages and cannot protect integrity\n- **CVE-2022-30320:** Programmable Logic Controller (PLC) uses a protocol with a cryptographically insecure hashing algorithm for passwords.\n- **CVE-2008-3775:** Product uses \"ROT-25\" to obfuscate the password in the registry.\n\n\n\n\n## CWE-321: Use of Hard-coded Cryptographic Key\n**Abstraction:** Variant\n**Status:** Draft\n\n### Description\nThe use of a hard-coded cryptographic key significantly increases the possibility that encrypted data may be recovered.\n\n### Extended Description\nNot provided\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-798\nChildOf -> CWE-798\nChildOf -> CWE-798\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n### Additional Notes\n**[Other]** The main difference between the use of hard-coded passwords and the use of hard-coded cryptographic keys is the false sense of security that the former conveys. Many people believe that simply hashing a hard-coded password before storage will protect the information from malicious users. However, many hashes are reversible (or at least vulnerable to brute force attacks) -- and further, many authentication protocols simply request the hash itself, making it no better than a password.\n\n**[Maintenance]** The Taxonomy_Mappings to ISA/IEC 62443 were added in CWE 4.10, but they are still under review and might change in future CWE versions. These draft mappings were performed by members of the \"Mapping CWE to 62443\" subgroup of the CWE-CAPEC ICS/OT Special Interest Group (SIG), and their work is incomplete as of CWE 4.10. The mappings are included to facilitate discussion and review by the broader ICS/OT community, and they are likely to change in future CWE versions.\n\n\n\n### Observed Examples\n- **CVE-2022-29960:** Engineering Workstation uses hard-coded cryptographic keys that could allow for unathorized filesystem access and privilege escalation\n- **CVE-2022-30271:** Remote Terminal Unit (RTU) uses a hard-coded SSH private key that is likely to be used by default.\n- **CVE-2020-10884:** WiFi router service has a hard-coded encryption key, allowing root access\n\n\n\n\n## CWE-1240: Use of a Cryptographic Primitive with a Risky Implementation\n**Abstraction:** Base\n**Status:** Draft\n\n### Description\nTo fulfill the need for a cryptographic primitive, the product implements a cryptographic algorithm using a non-standard, unproven, or disallowed/non-compliant cryptographic implementation.\n\n### Extended Description\n\n\nCryptographic protocols and systems depend on cryptographic primitives (and associated algorithms) as their basic building blocks. Some common examples of primitives are digital signatures, one-way hash functions, ciphers, and public key cryptography; however, the notion of \"primitive\" can vary depending on point of view. See \"Terminology Notes\" for further explanation of some concepts.\n\n\nCryptographic primitives are defined to accomplish one very specific task in a precisely defined and mathematically reliable fashion. For example, suppose that for a specific cryptographic primitive (such as an encryption routine), the consensus is that the primitive can only be broken after trying out N different inputs (where the larger the value of N, the stronger the cryptography). For an encryption scheme like AES-256, one would expect N to be so large as to be infeasible to execute in a reasonable amount of time.\n\n\nIf a vulnerability is ever found that shows that one can break a cryptographic primitive in significantly less than the expected number of attempts, then that primitive is considered weakened (or sometimes in extreme cases, colloquially it is \"broken\"). As a result, anything using this cryptographic primitive would now be considered insecure or risky. Thus, even breaking or weakening a seemingly small cryptographic primitive has the potential to render the whole system vulnerable, due to its reliance on the primitive. A historical example can be found in TLS when using DES. One would colloquially call DES the cryptographic primitive for transport encryption in this version of TLS. In the past, DES was considered strong, because no weaknesses were found in it; importantly, DES has a key length of 56 bits. Trying N=2^56 keys was considered impractical for most actors. Unfortunately, attacking a system with 56-bit keys is now practical via brute force, which makes defeating DES encryption practical. It is now practical for an adversary to read any information sent under this version of TLS and use this information to attack the system. As a result, it can be claimed that this use of TLS is weak, and that any system depending on TLS with DES could potentially render the entire system vulnerable to attack.\n\n\nCryptographic primitives and associated algorithms are only considered safe after extensive research and review from experienced cryptographers from academia, industry, and government entities looking for any possible flaws. Furthermore, cryptographic primitives and associated algorithms are frequently reevaluated for safety when new mathematical and attack techniques are discovered. As a result and over time, even well-known cryptographic primitives can lose their compliance status with the discovery of novel attacks that might either defeat the algorithm or reduce its robustness significantly.\n\n\nIf ad-hoc cryptographic primitives are implemented, it is almost certain that the implementation will be vulnerable to attacks that are well understood by cryptographers, resulting in the exposure of sensitive information and other consequences.\n\n\nThis weakness is even more difficult to manage for hardware-implemented deployment of cryptographic algorithms. First, because hardware is not patchable as easily as software, any flaw discovered after release and production typically cannot be fixed without a recall of the product. Secondly, the hardware product is often expected to work for years, during which time computation power available to the attacker only increases. Therefore, for hardware implementations of cryptographic primitives, it is absolutely essential that only strong, proven cryptographic primitives are used.\n\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-327\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n### Additional Notes\n**[Terminology]** \n\n Terminology for cryptography varies widely, from informal and colloquial to mathematically-defined, with different precision and formalism depending on whether the stakeholder is a developer, cryptologist, etc. Yet there is a need for CWE to be self-consistent while remaining understandable and acceptable to multiple audiences.\n\n\nAs of CWE 4.6, CWE terminology around \"primitives\" and \"algorithms\" is emerging as shown by the following example, subject to future consultation and agreement within the CWE and cryptography communities. Suppose one wishes to send encrypted data using a CLI tool such as OpenSSL. One might choose to use AES with a 256-bit key and require tamper protection (GCM mode, for instance). For compatibility's sake, one might also choose the ciphertext to be formatted to the PKCS#5 standard. In this case, the \"cryptographic system\" would be AES-256-GCM with PKCS#5 formatting. The \"cryptographic function\" would be AES-256 in the GCM mode of operation, and the \"algorithm\" would be AES. Colloquially, one would say that AES (and sometimes AES-256) is the \"cryptographic primitive,\" because it is the algorithm that realizes the concept of symmetric encryption (without modes of operation or other protocol related modifications). In practice, developers and architects typically refer to base cryptographic algorithms (AES, SHA, etc.) as cryptographic primitives.\n\n\n**[Maintenance]** Since CWE 4.4, various cryptography-related entries, including CWE-327 and CWE-1240, have been slated for extensive research, analysis, and community consultation to define consistent terminology, improve relationships, and reduce overlap or duplication. As of CWE 4.6, this work is still ongoing.\n\n\n\n### Observed Examples\n- **CVE-2020-4778:** software uses MD5, which is less safe than the default SHA-256 used by related products\n- **CVE-2005-2946:** Default configuration of product uses MD5 instead of stronger algorithms that are available, simplifying forgery of certificates.\n- **CVE-2019-3907:** identity card uses MD5 hash of a salt and password\n\n\n\n\n## CWE-208: Observable Timing Discrepancy\n**Abstraction:** Base\n**Status:** Incomplete\n\n### Description\nTwo separate operations in a product require different amounts of time to complete, in a way that is observable to an actor and reveals security-relevant information about the state of the product, such as whether a particular operation was successful or not.\n\n### Extended Description\nIn security-relevant contexts, even small variations in timing can be exploited by attackers to indirectly infer certain details about the product's internal operations. For example, in some cryptographic algorithms, attackers can use timing differences to infer certain properties about a private key, making the key easier to guess. Timing discrepancies effectively form a timing side channel.\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-203\nCanPrecede -> CWE-385\nCanPrecede -> CWE-327\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n### Additional Notes\n**[Relationship]** Often primary in cryptographic applications and algorithms.\n\n**[Maintenance]** CWE 4.16 removed a demonstrative example for a hardware module because it was inaccurate and unable to be adapted. The CWE team is developing an alternative.\n\n\n\n### Observed Examples\n- **CVE-2019-10071:** Java-oriented framework compares HMAC signatures using String.equals() instead of a constant-time algorithm, causing timing discrepancies\n- **CVE-2019-10482:** Smartphone OS uses comparison functions that are not in constant time, allowing side channels\n- **CVE-2014-0984:** Password-checking function in router terminates validation of a password entry when it encounters the first incorrect character, which allows remote attackers to obtain passwords via a brute-force attack that relies on timing differences in responses to incorrect password guesses, aka a timing side-channel attack.\n\n\n\n\n## CWE-780: Use of RSA Algorithm without OAEP\n**Abstraction:** Variant\n**Status:** Incomplete\n\n### Description\nThe product uses the RSA algorithm but does not incorporate Optimal Asymmetric Encryption Padding (OAEP), which might weaken the encryption.\n\n### Extended Description\nPadding schemes are often used with cryptographic algorithms to make the plaintext less predictable and complicate attack efforts. The OAEP scheme is often used with RSA to nullify the impact of predictable common text.\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-327\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n### Additional Notes\n**[Maintenance]** This entry could probably have a new parent related to improper padding, however the role of padding in cryptographic algorithms can vary, such as hiding the length of the plaintext and providing additional random bits for the cipher. In general, cryptographic problems in CWE are not well organized and further research is needed.\n\n\n\n\n\n\n## CWE-385: Covert Timing Channel\n**Abstraction:** Base\n**Status:** Incomplete\n\n### Description\nCovert timing channels convey information by modulating some aspect of system behavior over time, so that the program receiving the information can observe system behavior and infer protected information.\n\n### Extended Description\n\n\nIn some instances, knowing when data is transmitted between parties can provide a malicious user with privileged information. Also, externally monitoring the timing of operations can potentially reveal sensitive data. For example, a cryptographic operation can expose its internal state if the time it takes to perform the operation varies, based on the state.\n\n\nCovert channels are frequently classified as either storage or timing channels. Some examples of covert timing channels are the system's paging rate, the time a certain transaction requires to execute, and the time it takes to gain access to a shared bus.\n\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-514\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n### Additional Notes\n**[Maintenance]** As of CWE 4.9, members of the CWE Hardware SIG are working to improve CWE's coverage of transient execution weaknesses, which include issues related to Spectre, Meltdown, and other attacks that create or exploit covert channels. As a result of that work, this entry might change in CWE 4.10.\n\n\n\n\n\n\n## CWE-799: Improper Control of Interaction Frequency\n**Abstraction:** Class\n**Status:** Incomplete\n\n### Description\nThe product does not properly limit the number or frequency of interactions that it has with an actor, such as the number of incoming requests.\n\n### Extended Description\nThis can allow the actor to perform actions more frequently than expected. The actor could be a human or an automated process such as a virus or bot. This could be used to cause a denial of service, compromise program logic (such as limiting humans to a single vote), or other consequences. For example, an authentication routine might not limit the number of times an attacker can guess a password. Or, a web site might conduct a poll but only expect humans to vote a maximum of once a day.\n\n### Alternative Terms\nInsufficient anti-automation: The term \"insufficient anti-automation\" focuses primarly on non-human actors such as viruses or bots, but the scope of this CWE entry is broader.\nBrute force: Vulnerabilities that can be targeted using brute force attacks are often symptomatic of this weakness.\n\n### Relationships\nChildOf -> CWE-691\n\n### Mapping Guidance\n**Usage:** Allowed-with-Review\n**Rationale:** This CWE entry is a Class and might have Base-level children that would be more appropriate\n**Comments:** Examine children of this entry to see if there is a better fit\n**Reasons:**\n- Abstraction\n\n\n\n### Observed Examples\n- **CVE-2002-1876:** Mail server allows attackers to prevent other users from accessing mail by sending large number of rapid requests.\n\n\n\n\n## CWE-617: Reachable Assertion\n**Abstraction:** Base\n**Status:** Draft\n\n### Description\nThe product contains an assert() or similar statement that can be triggered by an attacker, which leads to an application exit or other behavior that is more severe than necessary.\n\n### Extended Description\n\n\nWhile assertion is good for catching logic errors and reducing the chances of reaching more serious vulnerability conditions, it can still lead to a denial of service.\n\n\nFor example, if a server handles multiple simultaneous connections, and an assert() occurs in one single connection that causes all other connections to be dropped, this is a reachable assertion that leads to a denial of service.\n\n\n### Alternative Terms\nassertion failure\n\n### Relationships\nChildOf -> CWE-670\nChildOf -> CWE-670\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n\n### Observed Examples\n- **CVE-2023-49286:** Chain: function in web caching proxy does not correctly check a return value (CWE-253) leading to a reachable assertion (CWE-617)\n- **CVE-2006-6767:** FTP server allows remote attackers to cause a denial of service (daemon abort) via crafted commands which trigger an assertion failure.\n- **CVE-2006-6811:** Chat client allows remote attackers to cause a denial of service (crash) via a long message string when connecting to a server, which causes an assertion failure.\n\n\n\n\n## CWE-522: Insufficiently Protected Credentials\n**Abstraction:** Class\n**Status:** Incomplete\n\n### Description\nThe product transmits or stores authentication credentials, but it uses an insecure method that is susceptible to unauthorized interception and/or retrieval.\n\n### Extended Description\nNot provided\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-1390\nChildOf -> CWE-287\nChildOf -> CWE-668\n\n### Mapping Guidance\n**Usage:** Allowed-with-Review\n**Rationale:** This CWE entry is a Class and might have Base-level children that would be more appropriate\n**Comments:** Examine children of this entry to see if there is a better fit\n**Reasons:**\n- Abstraction\n\n\n\n### Observed Examples\n- **CVE-2022-30018:** A messaging platform serializes all elements of User/Group objects, making private information available to adversaries\n- **CVE-2022-29959:** Initialization file contains credentials that can be decoded using a \"simple string transformation\"\n- **CVE-2022-35411:** Python-based RPC framework enables pickle functionality by default, allowing clients to unpickle untrusted data.\n\n Consider specifically these CWEs: CWE-208 CWE-203 CWE-327 CWE-321 CWE-1240 CWE-345 CWE-1391",
  "keyphrases": {
    "original_query": "## Vulnerability Description\nA vulnerability in the handling of RSA keys on devices running Cisco Adaptive Security Appliance (ASA) Software and Cisco Firepower Threat Defense (FTD) Software could allow an unauthenticated, remote attacker to retrieve an RSA private key. This vulnerability is due to a **logic error when the RSA key is stored in memory on a hardware platform that performs hardware-based cryptography**. An attacker could exploit this vulnerability by using a Lenstra side-channel attack against the targeted device. A successful exploit could allow the attacker to retrieve the RSA private key. The following conditions may be observed on an affected device This vulnerability will apply to approximately 5 percent of the RSA keys on a device that is running a vulnerable release of Cisco ASA Software or Cisco FTD Software not all RSA keys are expected to be affected due to mathematical calculations applied to the RSA key. The RSA key could be valid but have specific characteristics that make it vulnerable to the potential leak of the RSA private key. If an attacker obtains the RSA private key, they could use the key to impersonate a device that is running Cisco ASA Software or Cisco FTD Software or to decrypt the device traffic. See the Indicators of Compromise section for more information on the detection of this type of RSA key. The RSA key could be malformed and invalid. A malformed RSA key is not functional, and a TLS client connection to a device that is running Cisco ASA Software or Cisco FTD Software that uses the malformed RSA key will result in a TLS signature failure, which means a vulnerable software release created an invalid RSA signature that failed verification. If an attacker obtains the RSA private key, they could use the key to impersonate a device that is running Cisco ASA Software or Cisco FTD Software or to decrypt the device traffic.\n\n### Vulnerability Description Key Phrases\n- **rootcause:** **logic error when the RSA key is stored in memory on a hardware platform that performs hardware-based cryptography**\n- **impact:** retrieve an RSA private key\n- **vector:** Lenstra side-channel attack\n- **attacker:** unauthenticated remote attacker\n- **product:** Cisco Adaptive Security Appliance (ASA) Software and Cisco Firepower Threat Defense (FTD) Software\n\n## CVE Reference Links Content Summary\n```\n{\n  \"guidelines\": [\n    \"First verify if the content relates to the CVE specified based on the official description\",\n    \"If the content does not relate to this CVE, respond with \\\"UNRELATED\\\"\",\n    \"If no useful vulnerability information is found, respond with \\\"NOINFO\\\"\",\n    \"For relevant content, extract:\",\n    \"   - Root cause of vulnerability\",\n    \"   - Weaknesses/vulnerabilities present\",\n    \"   - Impact of exploitation\",\n    \"   - Attack vectors\",\n    \"   - Required attacker capabilities/position\",\n    \"Additional instructions:\",\n    \"- Preserve original technical details and descriptions\",\n    \"- Remove unrelated content\",\n    \"- Translate non-English content to English\",\n    \"- Note if the content provides more detail than the official CVE description\"\n  ],\n  \"relevant_content\": [\n    {\n      \"source\": \"sec.cloudapps.cisco.com_21caad6d_20250108_151400.html\",\n      \"vulnerability\": {\n        \"root_cause\": \"A logic error occurs when the RSA key is stored in memory on hardware platforms that perform hardware-based cryptography, leading to a potential vulnerability to a Lenstra side-channel attack.\",\n        \"weaknesses\": [\n          \"RSA private key can be retrieved due to logic error during storage on vulnerable hardware platforms.\",\n          \"Vulnerable RSA keys can be malformed or susceptible to private key leakage.\"\n        ],\n        \"impact\": \"An unauthenticated, remote attacker could potentially retrieve the RSA private key. The attacker could then use the key to impersonate a device running Cisco ASA or FTD software or decrypt the device traffic.\",\n        \"attack_vector\": \"The vulnerability can be exploited using a Lenstra side-channel attack against the targeted device.\",\n        \"attacker_capabilities\": \"An unauthenticated, remote attacker is required to conduct the Lenstra side-channel attack.\"\n      },\n      \"additional_details\": \"The document provides more granular details about the affected products and software releases, how to detect vulnerable RSA keys using a Cisco off-box detection script, syslog messages, error counters, device boot warnings and debug commands. It also lists the Cisco ASA and FTD Software features that are potentially vulnerable if a malformed or susceptible RSA key is associated with that feature's configuration. It also provides information about how to obtain fixed software\"\n    },\n    {\n      \"source\": \"github.com_de14dd7a_20250108_151354.html\",\n       \"vulnerability\": {\n          \"root_cause\": \"A logic error when the RSA key is stored in memory on a hardware platform that performs hardware-based cryptography, making it vulnerable to a Lenstra side-channel attack.\",\n          \"weaknesses\": [\n            \"RSA keys can be malformed and invalid.\",\n            \"RSA keys can have specific characteristics that make them vulnerable to a private key leak.\"\n           ],\n          \"impact\": \"An unauthenticated, remote attacker to retrieve the RSA private key. The key could be used to impersonate a Cisco ASA or FTD device.\",\n         \"attack_vector\": \"A Lenstra side-channel attack.\",\n          \"attacker_capabilities\":\"An unauthenticated, remote attacker.\"\n        },\n       \"additional_details\": \"This content provides information about a python script that can be used to check RSA keys exported from ASA or FTD devices for susceptibility to CVE-2022-20866, and includes details on system requirements, supported platforms, key export procedures, and examples of how to run the script.\"\n    },\n    {\n      \"source\": \"tools.cisco.com_806c2eaf_20250108_115033.html\",\n      \"vulnerability\": {\n        \"root_cause\": \"A logic error during RSA key storage in memory on hardware platforms that perform hardware-based cryptography which is exploited through a Lenstra side-channel attack.\",\n         \"weaknesses\": [\n          \"Vulnerable to Lenstra side-channel attack due to logic error during RSA key storage.\",\n          \"RSA keys may be malformed or susceptible to a private key leak.\"\n        ],\n        \"impact\": \"An unauthenticated remote attacker could retrieve the RSA private key, which can be used to impersonate devices or decrypt traffic.\",\n        \"attack_vector\": \"Lenstra side-channel attack.\",\n        \"attacker_capabilities\": \"An unauthenticated, remote attacker.\"\n      },\n      \"additional_details\": \"This content provides similar information to sec.cloudapps.cisco.com_21caad6d_20250108_151400.html but in a different format. It outlines how to determine if RSA keys are malformed or susceptible, and how to mitigate the vulnerability and provides fix information. It provides indicators of compromise on fixed releases only including syslogs, error counters and debug commands, and describes what can be observed during device boot.\"\n    },\n     {\n      \"source\": \"sec.cloudapps.cisco.com_4e190a99_20250108_151352.html\",\n       \"vulnerability\": {\n          \"root_cause\": \"A logic error when the RSA key is stored in memory on a hardware platform that performs hardware-based cryptography, leading to potential exploit via Lenstra side-channel attack.\",\n          \"weaknesses\": [\n           \"RSA keys can be malformed and invalid.\",\n           \"RSA keys can be susceptible to private key leaks.\"\n          ],\n          \"impact\": \"An unauthenticated, remote attacker can retrieve RSA private keys which could be used to impersonate affected Cisco ASA/FTD devices or to decrypt traffic.\",\n           \"attack_vector\":\"Lenstra side-channel attack.\",\n          \"attacker_capabilities\":\"An unauthenticated, remote attacker.\"\n       },\n        \"additional_details\": \"This content is in the form of a CSAF document, providing a machine-readable description of the vulnerability, including detailed information about affected products, indicators of compromise, how to check and remediate vulnerable RSA keys, and fix information.\"\n     }\n  ],\n  \"unrelated_content\": [\n    \"sec.cloudapps.cisco.com_f89a007b_20250108_151353.html\",\n    \"sec.cloudapps.cisco.com_2a2ebb74_20250108_151356.html\",\n    \"www.cisco.com_32921cb8_20250108_151353.html\",\n    \"sec.cloudapps.cisco.com_fa0c3199_20250108_151352.html\",\n    \"sec.cloudapps.cisco.com_31e1ccf5_20250108_151356.html\",\n    \"www.cisco.com_1c1a8903_20250108_151356.html\",\n     \"infoscience.epfl.ch_1daecdec_20250108_151359.html\",\n     \"sec.cloudapps.cisco.com_6b53f843_20250108_151357.html\"\n  ]\n}\n```\n\n## Retriever Results\n\n### Top Combined Results\n\n| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |\n|------|--------|------|-------------|-------|------------|-------------------|\n| 1 | 203 | Observable Discrepancy | Base | Allowed | sparse | 3.145 |\n| 2 | 327 | Use of a Broken or Risky Cryptographic Algorithm | Class | Allowed-with-Review | sparse | 2.124 |\n| 3 | 321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | sparse | 2.030 |\n| 4 | 1240 | Use of a Cryptographic Primitive with a Risky Implementation | Base | Allowed | sparse | 2.028 |\n| 5 | 208 | Observable Timing Discrepancy | Base | Allowed | sparse | 2.025 |\n| 6 | 780 | Use of RSA Algorithm without OAEP | Variant | Allowed | dense | 0.561 |\n| 7 | 385 | Covert Timing Channel | Base | Allowed | graph | 0.002 |\n| 8 | 799 | Improper Control of Interaction Frequency | Class | Allowed-with-Review | sparse | 2.013 |\n| 9 | 617 | Reachable Assertion | Base | Allowed | sparse | 1.961 |\n| 10 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 1.904 |\n\n\n\n# Complete CWE Specifications\n\n\n## CWE-203: Observable Discrepancy\n**Abstraction:** Base\n**Status:** Incomplete\n\n### Description\nThe product behaves differently or sends different responses under different circumstances in a way that is observable to an unauthorized actor, which exposes security-relevant information about the state of the product, such as whether a particular operation was successful or not.\n\n### Extended Description\nDiscrepancies can take many forms, and variations may be detectable in timing, control flow, communications such as replies or requests, or general behavior. These discrepancies can reveal information about the product's operation or internal state to an unauthorized actor. In some cases, discrepancies can be used by attackers to form a side channel.\n\n### Alternative Terms\nSide Channel Attack: Observable Discrepancies are at the root of side channel attacks.\n\n### Relationships\nChildOf -> CWE-200\nChildOf -> CWE-200\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n\n### Observed Examples\n- **CVE-2020-8695:** Observable discrepancy in the RAPL interface for some Intel processors allows information disclosure.\n- **CVE-2019-14353:** Crypto hardware wallet's power consumption relates to total number of pixels illuminated, creating a side channel in the USB connection that allows attackers to determine secrets displayed such as PIN numbers and passwords\n- **CVE-2019-10071:** Java-oriented framework compares HMAC signatures using String.equals() instead of a constant-time algorithm, causing timing discrepancies\n\n\n\n\n## CWE-327: Use of a Broken or Risky Cryptographic Algorithm\n**Abstraction:** Class\n**Status:** Draft\n\n### Description\nThe product uses a broken or risky cryptographic algorithm or protocol.\n\n### Extended Description\n\n\nCryptographic algorithms are the methods by which data is scrambled to prevent observation or influence by unauthorized actors. Insecure cryptography can be exploited to expose sensitive information, modify data in unexpected ways, spoof identities of other users or devices, or other impacts.\n\n\nIt is very difficult to produce a secure algorithm, and even high-profile algorithms by accomplished cryptographic experts have been broken. Well-known techniques exist to break or weaken various kinds of cryptography. Accordingly, there are a small number of well-understood and heavily studied algorithms that should be used by most products. Using a non-standard or known-insecure algorithm is dangerous because a determined adversary may be able to break the algorithm and compromise whatever data has been protected.\n\n\nSince the state of cryptography advances so rapidly, it is common for an algorithm to be considered \"unsafe\" even if it was once thought to be strong. This can happen when new attacks are discovered, or if computing power increases so much that the cryptographic algorithm no longer provides the amount of protection that was originally thought.\n\n\nFor a number of reasons, this weakness is even more challenging to manage with hardware deployment of cryptographic algorithms as opposed to software implementation. First, if a flaw is discovered with hardware-implemented cryptography, the flaw cannot be fixed in most cases without a recall of the product, because hardware is not easily replaceable like software. Second, because the hardware product is expected to work for years, the adversary's computing power will only increase over time.\n\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-693\nPeerOf -> CWE-311\n\n### Mapping Guidance\n**Usage:** Allowed-with-Review\n**Rationale:** This CWE entry is a Class and might have Base-level children that would be more appropriate\n**Comments:** Examine children of this entry to see if there is a better fit\n**Reasons:**\n- Abstraction\n\n\n### Additional Notes\n**[Maintenance]** Since CWE 4.4, various cryptography-related entries, including CWE-327 and CWE-1240, have been slated for extensive research, analysis, and community consultation to define consistent terminology, improve relationships, and reduce overlap or duplication. As of CWE 4.6, this work is still ongoing.\n\n**[Maintenance]** The Taxonomy_Mappings to ISA/IEC 62443 were added in CWE 4.10, but they are still under review and might change in future CWE versions. These draft mappings were performed by members of the \"Mapping CWE to 62443\" subgroup of the CWE-CAPEC ICS/OT Special Interest Group (SIG), and their work is incomplete as of CWE 4.10. The mappings are included to facilitate discussion and review by the broader ICS/OT community, and they are likely to change in future CWE versions.\n\n\n\n### Observed Examples\n- **CVE-2022-30273:** SCADA-based protocol supports a legacy encryption mode that uses Tiny Encryption Algorithm (TEA) in ECB mode, which leaks patterns in messages and cannot protect integrity\n- **CVE-2022-30320:** Programmable Logic Controller (PLC) uses a protocol with a cryptographically insecure hashing algorithm for passwords.\n- **CVE-2008-3775:** Product uses \"ROT-25\" to obfuscate the password in the registry.\n\n\n\n\n## CWE-321: Use of Hard-coded Cryptographic Key\n**Abstraction:** Variant\n**Status:** Draft\n\n### Description\nThe use of a hard-coded cryptographic key significantly increases the possibility that encrypted data may be recovered.\n\n### Extended Description\nNot provided\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-798\nChildOf -> CWE-798\nChildOf -> CWE-798\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n### Additional Notes\n**[Other]** The main difference between the use of hard-coded passwords and the use of hard-coded cryptographic keys is the false sense of security that the former conveys. Many people believe that simply hashing a hard-coded password before storage will protect the information from malicious users. However, many hashes are reversible (or at least vulnerable to brute force attacks) -- and further, many authentication protocols simply request the hash itself, making it no better than a password.\n\n**[Maintenance]** The Taxonomy_Mappings to ISA/IEC 62443 were added in CWE 4.10, but they are still under review and might change in future CWE versions. These draft mappings were performed by members of the \"Mapping CWE to 62443\" subgroup of the CWE-CAPEC ICS/OT Special Interest Group (SIG), and their work is incomplete as of CWE 4.10. The mappings are included to facilitate discussion and review by the broader ICS/OT community, and they are likely to change in future CWE versions.\n\n\n\n### Observed Examples\n- **CVE-2022-29960:** Engineering Workstation uses hard-coded cryptographic keys that could allow for unathorized filesystem access and privilege escalation\n- **CVE-2022-30271:** Remote Terminal Unit (RTU) uses a hard-coded SSH private key that is likely to be used by default.\n- **CVE-2020-10884:** WiFi router service has a hard-coded encryption key, allowing root access\n\n\n\n\n## CWE-1240: Use of a Cryptographic Primitive with a Risky Implementation\n**Abstraction:** Base\n**Status:** Draft\n\n### Description\nTo fulfill the need for a cryptographic primitive, the product implements a cryptographic algorithm using a non-standard, unproven, or disallowed/non-compliant cryptographic implementation.\n\n### Extended Description\n\n\nCryptographic protocols and systems depend on cryptographic primitives (and associated algorithms) as their basic building blocks. Some common examples of primitives are digital signatures, one-way hash functions, ciphers, and public key cryptography; however, the notion of \"primitive\" can vary depending on point of view. See \"Terminology Notes\" for further explanation of some concepts.\n\n\nCryptographic primitives are defined to accomplish one very specific task in a precisely defined and mathematically reliable fashion. For example, suppose that for a specific cryptographic primitive (such as an encryption routine), the consensus is that the primitive can only be broken after trying out N different inputs (where the larger the value of N, the stronger the cryptography). For an encryption scheme like AES-256, one would expect N to be so large as to be infeasible to execute in a reasonable amount of time.\n\n\nIf a vulnerability is ever found that shows that one can break a cryptographic primitive in significantly less than the expected number of attempts, then that primitive is considered weakened (or sometimes in extreme cases, colloquially it is \"broken\"). As a result, anything using this cryptographic primitive would now be considered insecure or risky. Thus, even breaking or weakening a seemingly small cryptographic primitive has the potential to render the whole system vulnerable, due to its reliance on the primitive. A historical example can be found in TLS when using DES. One would colloquially call DES the cryptographic primitive for transport encryption in this version of TLS. In the past, DES was considered strong, because no weaknesses were found in it; importantly, DES has a key length of 56 bits. Trying N=2^56 keys was considered impractical for most actors. Unfortunately, attacking a system with 56-bit keys is now practical via brute force, which makes defeating DES encryption practical. It is now practical for an adversary to read any information sent under this version of TLS and use this information to attack the system. As a result, it can be claimed that this use of TLS is weak, and that any system depending on TLS with DES could potentially render the entire system vulnerable to attack.\n\n\nCryptographic primitives and associated algorithms are only considered safe after extensive research and review from experienced cryptographers from academia, industry, and government entities looking for any possible flaws. Furthermore, cryptographic primitives and associated algorithms are frequently reevaluated for safety when new mathematical and attack techniques are discovered. As a result and over time, even well-known cryptographic primitives can lose their compliance status with the discovery of novel attacks that might either defeat the algorithm or reduce its robustness significantly.\n\n\nIf ad-hoc cryptographic primitives are implemented, it is almost certain that the implementation will be vulnerable to attacks that are well understood by cryptographers, resulting in the exposure of sensitive information and other consequences.\n\n\nThis weakness is even more difficult to manage for hardware-implemented deployment of cryptographic algorithms. First, because hardware is not patchable as easily as software, any flaw discovered after release and production typically cannot be fixed without a recall of the product. Secondly, the hardware product is often expected to work for years, during which time computation power available to the attacker only increases. Therefore, for hardware implementations of cryptographic primitives, it is absolutely essential that only strong, proven cryptographic primitives are used.\n\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-327\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n### Additional Notes\n**[Terminology]** \n\n Terminology for cryptography varies widely, from informal and colloquial to mathematically-defined, with different precision and formalism depending on whether the stakeholder is a developer, cryptologist, etc. Yet there is a need for CWE to be self-consistent while remaining understandable and acceptable to multiple audiences.\n\n\nAs of CWE 4.6, CWE terminology around \"primitives\" and \"algorithms\" is emerging as shown by the following example, subject to future consultation and agreement within the CWE and cryptography communities. Suppose one wishes to send encrypted data using a CLI tool such as OpenSSL. One might choose to use AES with a 256-bit key and require tamper protection (GCM mode, for instance). For compatibility's sake, one might also choose the ciphertext to be formatted to the PKCS#5 standard. In this case, the \"cryptographic system\" would be AES-256-GCM with PKCS#5 formatting. The \"cryptographic function\" would be AES-256 in the GCM mode of operation, and the \"algorithm\" would be AES. Colloquially, one would say that AES (and sometimes AES-256) is the \"cryptographic primitive,\" because it is the algorithm that realizes the concept of symmetric encryption (without modes of operation or other protocol related modifications). In practice, developers and architects typically refer to base cryptographic algorithms (AES, SHA, etc.) as cryptographic primitives.\n\n\n**[Maintenance]** Since CWE 4.4, various cryptography-related entries, including CWE-327 and CWE-1240, have been slated for extensive research, analysis, and community consultation to define consistent terminology, improve relationships, and reduce overlap or duplication. As of CWE 4.6, this work is still ongoing.\n\n\n\n### Observed Examples\n- **CVE-2020-4778:** software uses MD5, which is less safe than the default SHA-256 used by related products\n- **CVE-2005-2946:** Default configuration of product uses MD5 instead of stronger algorithms that are available, simplifying forgery of certificates.\n- **CVE-2019-3907:** identity card uses MD5 hash of a salt and password\n\n\n\n\n## CWE-208: Observable Timing Discrepancy\n**Abstraction:** Base\n**Status:** Incomplete\n\n### Description\nTwo separate operations in a product require different amounts of time to complete, in a way that is observable to an actor and reveals security-relevant information about the state of the product, such as whether a particular operation was successful or not.\n\n### Extended Description\nIn security-relevant contexts, even small variations in timing can be exploited by attackers to indirectly infer certain details about the product's internal operations. For example, in some cryptographic algorithms, attackers can use timing differences to infer certain properties about a private key, making the key easier to guess. Timing discrepancies effectively form a timing side channel.\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-203\nCanPrecede -> CWE-385\nCanPrecede -> CWE-327\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n### Additional Notes\n**[Relationship]** Often primary in cryptographic applications and algorithms.\n\n**[Maintenance]** CWE 4.16 removed a demonstrative example for a hardware module because it was inaccurate and unable to be adapted. The CWE team is developing an alternative.\n\n\n\n### Observed Examples\n- **CVE-2019-10071:** Java-oriented framework compares HMAC signatures using String.equals() instead of a constant-time algorithm, causing timing discrepancies\n- **CVE-2019-10482:** Smartphone OS uses comparison functions that are not in constant time, allowing side channels\n- **CVE-2014-0984:** Password-checking function in router terminates validation of a password entry when it encounters the first incorrect character, which allows remote attackers to obtain passwords via a brute-force attack that relies on timing differences in responses to incorrect password guesses, aka a timing side-channel attack.\n\n\n\n\n## CWE-780: Use of RSA Algorithm without OAEP\n**Abstraction:** Variant\n**Status:** Incomplete\n\n### Description\nThe product uses the RSA algorithm but does not incorporate Optimal Asymmetric Encryption Padding (OAEP), which might weaken the encryption.\n\n### Extended Description\nPadding schemes are often used with cryptographic algorithms to make the plaintext less predictable and complicate attack efforts. The OAEP scheme is often used with RSA to nullify the impact of predictable common text.\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-327\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n### Additional Notes\n**[Maintenance]** This entry could probably have a new parent related to improper padding, however the role of padding in cryptographic algorithms can vary, such as hiding the length of the plaintext and providing additional random bits for the cipher. In general, cryptographic problems in CWE are not well organized and further research is needed.\n\n\n\n\n\n\n## CWE-385: Covert Timing Channel\n**Abstraction:** Base\n**Status:** Incomplete\n\n### Description\nCovert timing channels convey information by modulating some aspect of system behavior over time, so that the program receiving the information can observe system behavior and infer protected information.\n\n### Extended Description\n\n\nIn some instances, knowing when data is transmitted between parties can provide a malicious user with privileged information. Also, externally monitoring the timing of operations can potentially reveal sensitive data. For example, a cryptographic operation can expose its internal state if the time it takes to perform the operation varies, based on the state.\n\n\nCovert channels are frequently classified as either storage or timing channels. Some examples of covert timing channels are the system's paging rate, the time a certain transaction requires to execute, and the time it takes to gain access to a shared bus.\n\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-514\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n### Additional Notes\n**[Maintenance]** As of CWE 4.9, members of the CWE Hardware SIG are working to improve CWE's coverage of transient execution weaknesses, which include issues related to Spectre, Meltdown, and other attacks that create or exploit covert channels. As a result of that work, this entry might change in CWE 4.10.\n\n\n\n\n\n\n## CWE-799: Improper Control of Interaction Frequency\n**Abstraction:** Class\n**Status:** Incomplete\n\n### Description\nThe product does not properly limit the number or frequency of interactions that it has with an actor, such as the number of incoming requests.\n\n### Extended Description\nThis can allow the actor to perform actions more frequently than expected. The actor could be a human or an automated process such as a virus or bot. This could be used to cause a denial of service, compromise program logic (such as limiting humans to a single vote), or other consequences. For example, an authentication routine might not limit the number of times an attacker can guess a password. Or, a web site might conduct a poll but only expect humans to vote a maximum of once a day.\n\n### Alternative Terms\nInsufficient anti-automation: The term \"insufficient anti-automation\" focuses primarly on non-human actors such as viruses or bots, but the scope of this CWE entry is broader.\nBrute force: Vulnerabilities that can be targeted using brute force attacks are often symptomatic of this weakness.\n\n### Relationships\nChildOf -> CWE-691\n\n### Mapping Guidance\n**Usage:** Allowed-with-Review\n**Rationale:** This CWE entry is a Class and might have Base-level children that would be more appropriate\n**Comments:** Examine children of this entry to see if there is a better fit\n**Reasons:**\n- Abstraction\n\n\n\n### Observed Examples\n- **CVE-2002-1876:** Mail server allows attackers to prevent other users from accessing mail by sending large number of rapid requests.\n\n\n\n\n## CWE-617: Reachable Assertion\n**Abstraction:** Base\n**Status:** Draft\n\n### Description\nThe product contains an assert() or similar statement that can be triggered by an attacker, which leads to an application exit or other behavior that is more severe than necessary.\n\n### Extended Description\n\n\nWhile assertion is good for catching logic errors and reducing the chances of reaching more serious vulnerability conditions, it can still lead to a denial of service.\n\n\nFor example, if a server handles multiple simultaneous connections, and an assert() occurs in one single connection that causes all other connections to be dropped, this is a reachable assertion that leads to a denial of service.\n\n\n### Alternative Terms\nassertion failure\n\n### Relationships\nChildOf -> CWE-670\nChildOf -> CWE-670\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n\n### Observed Examples\n- **CVE-2023-49286:** Chain: function in web caching proxy does not correctly check a return value (CWE-253) leading to a reachable assertion (CWE-617)\n- **CVE-2006-6767:** FTP server allows remote attackers to cause a denial of service (daemon abort) via crafted commands which trigger an assertion failure.\n- **CVE-2006-6811:** Chat client allows remote attackers to cause a denial of service (crash) via a long message string when connecting to a server, which causes an assertion failure.\n\n\n\n\n## CWE-522: Insufficiently Protected Credentials\n**Abstraction:** Class\n**Status:** Incomplete\n\n### Description\nThe product transmits or stores authentication credentials, but it uses an insecure method that is susceptible to unauthorized interception and/or retrieval.\n\n### Extended Description\nNot provided\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-1390\nChildOf -> CWE-287\nChildOf -> CWE-668\n\n### Mapping Guidance\n**Usage:** Allowed-with-Review\n**Rationale:** This CWE entry is a Class and might have Base-level children that would be more appropriate\n**Comments:** Examine children of this entry to see if there is a better fit\n**Reasons:**\n- Abstraction\n\n\n\n### Observed Examples\n- **CVE-2022-30018:** A messaging platform serializes all elements of User/Group objects, making private information available to adversaries\n- **CVE-2022-29959:** Initialization file contains credentials that can be decoded using a \"simple string transformation\"\n- **CVE-2022-35411:** Python-based RPC framework enables pickle functionality by default, allowing clients to unpickle untrusted data.\n\n",
    "enhanced_query": "## Vulnerability Description\nA vulnerability in the handling of RSA keys on devices running Cisco Adaptive Security Appliance (ASA) Software and Cisco Firepower Threat Defense (FTD) Software could allow an unauthenticated, remote attacker to retrieve an RSA private key. This vulnerability is due to a **logic error when the RSA key is stored in memory on a hardware platform that performs hardware-based cryptography**. An attacker could exploit this vulnerability by using a Lenstra side-channel attack against the targeted device. A successful exploit could allow the attacker to retrieve the RSA private key. The following conditions may be observed on an affected device This vulnerability will apply to approximately 5 percent of the RSA keys on a device that is running a vulnerable release of Cisco ASA Software or Cisco FTD Software not all RSA keys are expected to be affected due to mathematical calculations applied to the RSA key. The RSA key could be valid but have specific characteristics that make it vulnerable to the potential leak of the RSA private key. If an attacker obtains the RSA private key, they could use the key to impersonate a device that is running Cisco ASA Software or Cisco FTD Software or to decrypt the device traffic. See the Indicators of Compromise section for more information on the detection of this type of RSA key. The RSA key could be malformed and invalid. A malformed RSA key is not functional, and a TLS client connection to a device that is running Cisco ASA Software or Cisco FTD Software that uses the malformed RSA key will result in a TLS signature failure, which means a vulnerable software release created an invalid RSA signature that failed verification. If an attacker obtains the RSA private key, they could use the key to impersonate a device that is running Cisco ASA Software or Cisco FTD Software or to decrypt the device traffic.\n\n### Vulnerability Description Key Phrases\n- **rootcause:** **logic error when the RSA key is stored in memory on a hardware platform that performs hardware-based cryptography**\n- **impact:** retrieve an RSA private key\n- **vector:** Lenstra side-channel attack\n- **attacker:** unauthenticated remote attacker\n- **product:** Cisco Adaptive Security Appliance (ASA) Software and Cisco Firepower Threat Defense (FTD) Software\n\n## CVE Reference Links Content Summary\n```\n{\n  \"guidelines\": [\n    \"First verify if the content relates to the CVE specified based on the official description\",\n    \"If the content does not relate to this CVE, respond with \\\"UNRELATED\\\"\",\n    \"If no useful vulnerability information is found, respond with \\\"NOINFO\\\"\",\n    \"For relevant content, extract:\",\n    \"   - Root cause of vulnerability\",\n    \"   - Weaknesses/vulnerabilities present\",\n    \"   - Impact of exploitation\",\n    \"   - Attack vectors\",\n    \"   - Required attacker capabilities/position\",\n    \"Additional instructions:\",\n    \"- Preserve original technical details and descriptions\",\n    \"- Remove unrelated content\",\n    \"- Translate non-English content to English\",\n    \"- Note if the content provides more detail than the official CVE description\"\n  ],\n  \"relevant_content\": [\n    {\n      \"source\": \"sec.cloudapps.cisco.com_21caad6d_20250108_151400.html\",\n      \"vulnerability\": {\n        \"root_cause\": \"A logic error occurs when the RSA key is stored in memory on hardware platforms that perform hardware-based cryptography, leading to a potential vulnerability to a Lenstra side-channel attack.\",\n        \"weaknesses\": [\n          \"RSA private key can be retrieved due to logic error during storage on vulnerable hardware platforms.\",\n          \"Vulnerable RSA keys can be malformed or susceptible to private key leakage.\"\n        ],\n        \"impact\": \"An unauthenticated, remote attacker could potentially retrieve the RSA private key. The attacker could then use the key to impersonate a device running Cisco ASA or FTD software or decrypt the device traffic.\",\n        \"attack_vector\": \"The vulnerability can be exploited using a Lenstra side-channel attack against the targeted device.\",\n        \"attacker_capabilities\": \"An unauthenticated, remote attacker is required to conduct the Lenstra side-channel attack.\"\n      },\n      \"additional_details\": \"The document provides more granular details about the affected products and software releases, how to detect vulnerable RSA keys using a Cisco off-box detection script, syslog messages, error counters, device boot warnings and debug commands. It also lists the Cisco ASA and FTD Software features that are potentially vulnerable if a malformed or susceptible RSA key is associated with that feature's configuration. It also provides information about how to obtain fixed software\"\n    },\n    {\n      \"source\": \"github.com_de14dd7a_20250108_151354.html\",\n       \"vulnerability\": {\n          \"root_cause\": \"A logic error when the RSA key is stored in memory on a hardware platform that performs hardware-based cryptography, making it vulnerable to a Lenstra side-channel attack.\",\n          \"weaknesses\": [\n            \"RSA keys can be malformed and invalid.\",\n            \"RSA keys can have specific characteristics that make them vulnerable to a private key leak.\"\n           ],\n          \"impact\": \"An unauthenticated, remote attacker to retrieve the RSA private key. The key could be used to impersonate a Cisco ASA or FTD device.\",\n         \"attack_vector\": \"A Lenstra side-channel attack.\",\n          \"attacker_capabilities\":\"An unauthenticated, remote attacker.\"\n        },\n       \"additional_details\": \"This content provides information about a python script that can be used to check RSA keys exported from ASA or FTD devices for susceptibility to CVE-2022-20866, and includes details on system requirements, supported platforms, key export procedures, and examples of how to run the script.\"\n    },\n    {\n      \"source\": \"tools.cisco.com_806c2eaf_20250108_115033.html\",\n      \"vulnerability\": {\n        \"root_cause\": \"A logic error during RSA key storage in memory on hardware platforms that perform hardware-based cryptography which is exploited through a Lenstra side-channel attack.\",\n         \"weaknesses\": [\n          \"Vulnerable to Lenstra side-channel attack due to logic error during RSA key storage.\",\n          \"RSA keys may be malformed or susceptible to a private key leak.\"\n        ],\n        \"impact\": \"An unauthenticated remote attacker could retrieve the RSA private key, which can be used to impersonate devices or decrypt traffic.\",\n        \"attack_vector\": \"Lenstra side-channel attack.\",\n        \"attacker_capabilities\": \"An unauthenticated, remote attacker.\"\n      },\n      \"additional_details\": \"This content provides similar information to sec.cloudapps.cisco.com_21caad6d_20250108_151400.html but in a different format. It outlines how to determine if RSA keys are malformed or susceptible, and how to mitigate the vulnerability and provides fix information. It provides indicators of compromise on fixed releases only including syslogs, error counters and debug commands, and describes what can be observed during device boot.\"\n    },\n     {\n      \"source\": \"sec.cloudapps.cisco.com_4e190a99_20250108_151352.html\",\n       \"vulnerability\": {\n          \"root_cause\": \"A logic error when the RSA key is stored in memory on a hardware platform that performs hardware-based cryptography, leading to potential exploit via Lenstra side-channel attack.\",\n          \"weaknesses\": [\n           \"RSA keys can be malformed and invalid.\",\n           \"RSA keys can be susceptible to private key leaks.\"\n          ],\n          \"impact\": \"An unauthenticated, remote attacker can retrieve RSA private keys which could be used to impersonate affected Cisco ASA/FTD devices or to decrypt traffic.\",\n           \"attack_vector\":\"Lenstra side-channel attack.\",\n          \"attacker_capabilities\":\"An unauthenticated, remote attacker.\"\n       },\n        \"additional_details\": \"This content is in the form of a CSAF document, providing a machine-readable description of the vulnerability, including detailed information about affected products, indicators of compromise, how to check and remediate vulnerable RSA keys, and fix information.\"\n     }\n  ],\n  \"unrelated_content\": [\n    \"sec.cloudapps.cisco.com_f89a007b_20250108_151353.html\",\n    \"sec.cloudapps.cisco.com_2a2ebb74_20250108_151356.html\",\n    \"www.cisco.com_32921cb8_20250108_151353.html\",\n    \"sec.cloudapps.cisco.com_fa0c3199_20250108_151352.html\",\n    \"sec.cloudapps.cisco.com_31e1ccf5_20250108_151356.html\",\n    \"www.cisco.com_1c1a8903_20250108_151356.html\",\n     \"infoscience.epfl.ch_1daecdec_20250108_151359.html\",\n     \"sec.cloudapps.cisco.com_6b53f843_20250108_151357.html\"\n  ]\n}\n```\n\n## Retriever Results\n\n### Top Combined Results\n\n| Rank | CWE ID | Name | Abstraction | Usage  | Retrievers | Individual Scores |\n|------|--------|------|-------------|-------|------------|-------------------|\n| 1 | 203 | Observable Discrepancy | Base | Allowed | sparse | 3.145 |\n| 2 | 327 | Use of a Broken or Risky Cryptographic Algorithm | Class | Allowed-with-Review | sparse | 2.124 |\n| 3 | 321 | Use of Hard-coded Cryptographic Key | Variant | Allowed | sparse | 2.030 |\n| 4 | 1240 | Use of a Cryptographic Primitive with a Risky Implementation | Base | Allowed | sparse | 2.028 |\n| 5 | 208 | Observable Timing Discrepancy | Base | Allowed | sparse | 2.025 |\n| 6 | 780 | Use of RSA Algorithm without OAEP | Variant | Allowed | dense | 0.561 |\n| 7 | 385 | Covert Timing Channel | Base | Allowed | graph | 0.002 |\n| 8 | 799 | Improper Control of Interaction Frequency | Class | Allowed-with-Review | sparse | 2.013 |\n| 9 | 617 | Reachable Assertion | Base | Allowed | sparse | 1.961 |\n| 10 | 522 | Insufficiently Protected Credentials | Class | Allowed-with-Review | sparse | 1.904 |\n\n\n\n# Complete CWE Specifications\n\n\n## CWE-203: Observable Discrepancy\n**Abstraction:** Base\n**Status:** Incomplete\n\n### Description\nThe product behaves differently or sends different responses under different circumstances in a way that is observable to an unauthorized actor, which exposes security-relevant information about the state of the product, such as whether a particular operation was successful or not.\n\n### Extended Description\nDiscrepancies can take many forms, and variations may be detectable in timing, control flow, communications such as replies or requests, or general behavior. These discrepancies can reveal information about the product's operation or internal state to an unauthorized actor. In some cases, discrepancies can be used by attackers to form a side channel.\n\n### Alternative Terms\nSide Channel Attack: Observable Discrepancies are at the root of side channel attacks.\n\n### Relationships\nChildOf -> CWE-200\nChildOf -> CWE-200\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n\n### Observed Examples\n- **CVE-2020-8695:** Observable discrepancy in the RAPL interface for some Intel processors allows information disclosure.\n- **CVE-2019-14353:** Crypto hardware wallet's power consumption relates to total number of pixels illuminated, creating a side channel in the USB connection that allows attackers to determine secrets displayed such as PIN numbers and passwords\n- **CVE-2019-10071:** Java-oriented framework compares HMAC signatures using String.equals() instead of a constant-time algorithm, causing timing discrepancies\n\n\n\n\n## CWE-327: Use of a Broken or Risky Cryptographic Algorithm\n**Abstraction:** Class\n**Status:** Draft\n\n### Description\nThe product uses a broken or risky cryptographic algorithm or protocol.\n\n### Extended Description\n\n\nCryptographic algorithms are the methods by which data is scrambled to prevent observation or influence by unauthorized actors. Insecure cryptography can be exploited to expose sensitive information, modify data in unexpected ways, spoof identities of other users or devices, or other impacts.\n\n\nIt is very difficult to produce a secure algorithm, and even high-profile algorithms by accomplished cryptographic experts have been broken. Well-known techniques exist to break or weaken various kinds of cryptography. Accordingly, there are a small number of well-understood and heavily studied algorithms that should be used by most products. Using a non-standard or known-insecure algorithm is dangerous because a determined adversary may be able to break the algorithm and compromise whatever data has been protected.\n\n\nSince the state of cryptography advances so rapidly, it is common for an algorithm to be considered \"unsafe\" even if it was once thought to be strong. This can happen when new attacks are discovered, or if computing power increases so much that the cryptographic algorithm no longer provides the amount of protection that was originally thought.\n\n\nFor a number of reasons, this weakness is even more challenging to manage with hardware deployment of cryptographic algorithms as opposed to software implementation. First, if a flaw is discovered with hardware-implemented cryptography, the flaw cannot be fixed in most cases without a recall of the product, because hardware is not easily replaceable like software. Second, because the hardware product is expected to work for years, the adversary's computing power will only increase over time.\n\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-693\nPeerOf -> CWE-311\n\n### Mapping Guidance\n**Usage:** Allowed-with-Review\n**Rationale:** This CWE entry is a Class and might have Base-level children that would be more appropriate\n**Comments:** Examine children of this entry to see if there is a better fit\n**Reasons:**\n- Abstraction\n\n\n### Additional Notes\n**[Maintenance]** Since CWE 4.4, various cryptography-related entries, including CWE-327 and CWE-1240, have been slated for extensive research, analysis, and community consultation to define consistent terminology, improve relationships, and reduce overlap or duplication. As of CWE 4.6, this work is still ongoing.\n\n**[Maintenance]** The Taxonomy_Mappings to ISA/IEC 62443 were added in CWE 4.10, but they are still under review and might change in future CWE versions. These draft mappings were performed by members of the \"Mapping CWE to 62443\" subgroup of the CWE-CAPEC ICS/OT Special Interest Group (SIG), and their work is incomplete as of CWE 4.10. The mappings are included to facilitate discussion and review by the broader ICS/OT community, and they are likely to change in future CWE versions.\n\n\n\n### Observed Examples\n- **CVE-2022-30273:** SCADA-based protocol supports a legacy encryption mode that uses Tiny Encryption Algorithm (TEA) in ECB mode, which leaks patterns in messages and cannot protect integrity\n- **CVE-2022-30320:** Programmable Logic Controller (PLC) uses a protocol with a cryptographically insecure hashing algorithm for passwords.\n- **CVE-2008-3775:** Product uses \"ROT-25\" to obfuscate the password in the registry.\n\n\n\n\n## CWE-321: Use of Hard-coded Cryptographic Key\n**Abstraction:** Variant\n**Status:** Draft\n\n### Description\nThe use of a hard-coded cryptographic key significantly increases the possibility that encrypted data may be recovered.\n\n### Extended Description\nNot provided\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-798\nChildOf -> CWE-798\nChildOf -> CWE-798\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n### Additional Notes\n**[Other]** The main difference between the use of hard-coded passwords and the use of hard-coded cryptographic keys is the false sense of security that the former conveys. Many people believe that simply hashing a hard-coded password before storage will protect the information from malicious users. However, many hashes are reversible (or at least vulnerable to brute force attacks) -- and further, many authentication protocols simply request the hash itself, making it no better than a password.\n\n**[Maintenance]** The Taxonomy_Mappings to ISA/IEC 62443 were added in CWE 4.10, but they are still under review and might change in future CWE versions. These draft mappings were performed by members of the \"Mapping CWE to 62443\" subgroup of the CWE-CAPEC ICS/OT Special Interest Group (SIG), and their work is incomplete as of CWE 4.10. The mappings are included to facilitate discussion and review by the broader ICS/OT community, and they are likely to change in future CWE versions.\n\n\n\n### Observed Examples\n- **CVE-2022-29960:** Engineering Workstation uses hard-coded cryptographic keys that could allow for unathorized filesystem access and privilege escalation\n- **CVE-2022-30271:** Remote Terminal Unit (RTU) uses a hard-coded SSH private key that is likely to be used by default.\n- **CVE-2020-10884:** WiFi router service has a hard-coded encryption key, allowing root access\n\n\n\n\n## CWE-1240: Use of a Cryptographic Primitive with a Risky Implementation\n**Abstraction:** Base\n**Status:** Draft\n\n### Description\nTo fulfill the need for a cryptographic primitive, the product implements a cryptographic algorithm using a non-standard, unproven, or disallowed/non-compliant cryptographic implementation.\n\n### Extended Description\n\n\nCryptographic protocols and systems depend on cryptographic primitives (and associated algorithms) as their basic building blocks. Some common examples of primitives are digital signatures, one-way hash functions, ciphers, and public key cryptography; however, the notion of \"primitive\" can vary depending on point of view. See \"Terminology Notes\" for further explanation of some concepts.\n\n\nCryptographic primitives are defined to accomplish one very specific task in a precisely defined and mathematically reliable fashion. For example, suppose that for a specific cryptographic primitive (such as an encryption routine), the consensus is that the primitive can only be broken after trying out N different inputs (where the larger the value of N, the stronger the cryptography). For an encryption scheme like AES-256, one would expect N to be so large as to be infeasible to execute in a reasonable amount of time.\n\n\nIf a vulnerability is ever found that shows that one can break a cryptographic primitive in significantly less than the expected number of attempts, then that primitive is considered weakened (or sometimes in extreme cases, colloquially it is \"broken\"). As a result, anything using this cryptographic primitive would now be considered insecure or risky. Thus, even breaking or weakening a seemingly small cryptographic primitive has the potential to render the whole system vulnerable, due to its reliance on the primitive. A historical example can be found in TLS when using DES. One would colloquially call DES the cryptographic primitive for transport encryption in this version of TLS. In the past, DES was considered strong, because no weaknesses were found in it; importantly, DES has a key length of 56 bits. Trying N=2^56 keys was considered impractical for most actors. Unfortunately, attacking a system with 56-bit keys is now practical via brute force, which makes defeating DES encryption practical. It is now practical for an adversary to read any information sent under this version of TLS and use this information to attack the system. As a result, it can be claimed that this use of TLS is weak, and that any system depending on TLS with DES could potentially render the entire system vulnerable to attack.\n\n\nCryptographic primitives and associated algorithms are only considered safe after extensive research and review from experienced cryptographers from academia, industry, and government entities looking for any possible flaws. Furthermore, cryptographic primitives and associated algorithms are frequently reevaluated for safety when new mathematical and attack techniques are discovered. As a result and over time, even well-known cryptographic primitives can lose their compliance status with the discovery of novel attacks that might either defeat the algorithm or reduce its robustness significantly.\n\n\nIf ad-hoc cryptographic primitives are implemented, it is almost certain that the implementation will be vulnerable to attacks that are well understood by cryptographers, resulting in the exposure of sensitive information and other consequences.\n\n\nThis weakness is even more difficult to manage for hardware-implemented deployment of cryptographic algorithms. First, because hardware is not patchable as easily as software, any flaw discovered after release and production typically cannot be fixed without a recall of the product. Secondly, the hardware product is often expected to work for years, during which time computation power available to the attacker only increases. Therefore, for hardware implementations of cryptographic primitives, it is absolutely essential that only strong, proven cryptographic primitives are used.\n\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-327\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n### Additional Notes\n**[Terminology]** \n\n Terminology for cryptography varies widely, from informal and colloquial to mathematically-defined, with different precision and formalism depending on whether the stakeholder is a developer, cryptologist, etc. Yet there is a need for CWE to be self-consistent while remaining understandable and acceptable to multiple audiences.\n\n\nAs of CWE 4.6, CWE terminology around \"primitives\" and \"algorithms\" is emerging as shown by the following example, subject to future consultation and agreement within the CWE and cryptography communities. Suppose one wishes to send encrypted data using a CLI tool such as OpenSSL. One might choose to use AES with a 256-bit key and require tamper protection (GCM mode, for instance). For compatibility's sake, one might also choose the ciphertext to be formatted to the PKCS#5 standard. In this case, the \"cryptographic system\" would be AES-256-GCM with PKCS#5 formatting. The \"cryptographic function\" would be AES-256 in the GCM mode of operation, and the \"algorithm\" would be AES. Colloquially, one would say that AES (and sometimes AES-256) is the \"cryptographic primitive,\" because it is the algorithm that realizes the concept of symmetric encryption (without modes of operation or other protocol related modifications). In practice, developers and architects typically refer to base cryptographic algorithms (AES, SHA, etc.) as cryptographic primitives.\n\n\n**[Maintenance]** Since CWE 4.4, various cryptography-related entries, including CWE-327 and CWE-1240, have been slated for extensive research, analysis, and community consultation to define consistent terminology, improve relationships, and reduce overlap or duplication. As of CWE 4.6, this work is still ongoing.\n\n\n\n### Observed Examples\n- **CVE-2020-4778:** software uses MD5, which is less safe than the default SHA-256 used by related products\n- **CVE-2005-2946:** Default configuration of product uses MD5 instead of stronger algorithms that are available, simplifying forgery of certificates.\n- **CVE-2019-3907:** identity card uses MD5 hash of a salt and password\n\n\n\n\n## CWE-208: Observable Timing Discrepancy\n**Abstraction:** Base\n**Status:** Incomplete\n\n### Description\nTwo separate operations in a product require different amounts of time to complete, in a way that is observable to an actor and reveals security-relevant information about the state of the product, such as whether a particular operation was successful or not.\n\n### Extended Description\nIn security-relevant contexts, even small variations in timing can be exploited by attackers to indirectly infer certain details about the product's internal operations. For example, in some cryptographic algorithms, attackers can use timing differences to infer certain properties about a private key, making the key easier to guess. Timing discrepancies effectively form a timing side channel.\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-203\nCanPrecede -> CWE-385\nCanPrecede -> CWE-327\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n### Additional Notes\n**[Relationship]** Often primary in cryptographic applications and algorithms.\n\n**[Maintenance]** CWE 4.16 removed a demonstrative example for a hardware module because it was inaccurate and unable to be adapted. The CWE team is developing an alternative.\n\n\n\n### Observed Examples\n- **CVE-2019-10071:** Java-oriented framework compares HMAC signatures using String.equals() instead of a constant-time algorithm, causing timing discrepancies\n- **CVE-2019-10482:** Smartphone OS uses comparison functions that are not in constant time, allowing side channels\n- **CVE-2014-0984:** Password-checking function in router terminates validation of a password entry when it encounters the first incorrect character, which allows remote attackers to obtain passwords via a brute-force attack that relies on timing differences in responses to incorrect password guesses, aka a timing side-channel attack.\n\n\n\n\n## CWE-780: Use of RSA Algorithm without OAEP\n**Abstraction:** Variant\n**Status:** Incomplete\n\n### Description\nThe product uses the RSA algorithm but does not incorporate Optimal Asymmetric Encryption Padding (OAEP), which might weaken the encryption.\n\n### Extended Description\nPadding schemes are often used with cryptographic algorithms to make the plaintext less predictable and complicate attack efforts. The OAEP scheme is often used with RSA to nullify the impact of predictable common text.\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-327\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Variant level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n### Additional Notes\n**[Maintenance]** This entry could probably have a new parent related to improper padding, however the role of padding in cryptographic algorithms can vary, such as hiding the length of the plaintext and providing additional random bits for the cipher. In general, cryptographic problems in CWE are not well organized and further research is needed.\n\n\n\n\n\n\n## CWE-385: Covert Timing Channel\n**Abstraction:** Base\n**Status:** Incomplete\n\n### Description\nCovert timing channels convey information by modulating some aspect of system behavior over time, so that the program receiving the information can observe system behavior and infer protected information.\n\n### Extended Description\n\n\nIn some instances, knowing when data is transmitted between parties can provide a malicious user with privileged information. Also, externally monitoring the timing of operations can potentially reveal sensitive data. For example, a cryptographic operation can expose its internal state if the time it takes to perform the operation varies, based on the state.\n\n\nCovert channels are frequently classified as either storage or timing channels. Some examples of covert timing channels are the system's paging rate, the time a certain transaction requires to execute, and the time it takes to gain access to a shared bus.\n\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-514\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n### Additional Notes\n**[Maintenance]** As of CWE 4.9, members of the CWE Hardware SIG are working to improve CWE's coverage of transient execution weaknesses, which include issues related to Spectre, Meltdown, and other attacks that create or exploit covert channels. As a result of that work, this entry might change in CWE 4.10.\n\n\n\n\n\n\n## CWE-799: Improper Control of Interaction Frequency\n**Abstraction:** Class\n**Status:** Incomplete\n\n### Description\nThe product does not properly limit the number or frequency of interactions that it has with an actor, such as the number of incoming requests.\n\n### Extended Description\nThis can allow the actor to perform actions more frequently than expected. The actor could be a human or an automated process such as a virus or bot. This could be used to cause a denial of service, compromise program logic (such as limiting humans to a single vote), or other consequences. For example, an authentication routine might not limit the number of times an attacker can guess a password. Or, a web site might conduct a poll but only expect humans to vote a maximum of once a day.\n\n### Alternative Terms\nInsufficient anti-automation: The term \"insufficient anti-automation\" focuses primarly on non-human actors such as viruses or bots, but the scope of this CWE entry is broader.\nBrute force: Vulnerabilities that can be targeted using brute force attacks are often symptomatic of this weakness.\n\n### Relationships\nChildOf -> CWE-691\n\n### Mapping Guidance\n**Usage:** Allowed-with-Review\n**Rationale:** This CWE entry is a Class and might have Base-level children that would be more appropriate\n**Comments:** Examine children of this entry to see if there is a better fit\n**Reasons:**\n- Abstraction\n\n\n\n### Observed Examples\n- **CVE-2002-1876:** Mail server allows attackers to prevent other users from accessing mail by sending large number of rapid requests.\n\n\n\n\n## CWE-617: Reachable Assertion\n**Abstraction:** Base\n**Status:** Draft\n\n### Description\nThe product contains an assert() or similar statement that can be triggered by an attacker, which leads to an application exit or other behavior that is more severe than necessary.\n\n### Extended Description\n\n\nWhile assertion is good for catching logic errors and reducing the chances of reaching more serious vulnerability conditions, it can still lead to a denial of service.\n\n\nFor example, if a server handles multiple simultaneous connections, and an assert() occurs in one single connection that causes all other connections to be dropped, this is a reachable assertion that leads to a denial of service.\n\n\n### Alternative Terms\nassertion failure\n\n### Relationships\nChildOf -> CWE-670\nChildOf -> CWE-670\n\n### Mapping Guidance\n**Usage:** Allowed\n**Rationale:** This CWE entry is at the Base level of abstraction, which is a preferred level of abstraction for mapping to the root causes of vulnerabilities.\n**Comments:** Carefully read both the name and description to ensure that this mapping is an appropriate fit. Do not try to 'force' a mapping to a lower-level Base/Variant simply to comply with this preferred level of abstraction.\n**Reasons:**\n- Acceptable-Use\n\n\n\n### Observed Examples\n- **CVE-2023-49286:** Chain: function in web caching proxy does not correctly check a return value (CWE-253) leading to a reachable assertion (CWE-617)\n- **CVE-2006-6767:** FTP server allows remote attackers to cause a denial of service (daemon abort) via crafted commands which trigger an assertion failure.\n- **CVE-2006-6811:** Chat client allows remote attackers to cause a denial of service (crash) via a long message string when connecting to a server, which causes an assertion failure.\n\n\n\n\n## CWE-522: Insufficiently Protected Credentials\n**Abstraction:** Class\n**Status:** Incomplete\n\n### Description\nThe product transmits or stores authentication credentials, but it uses an insecure method that is susceptible to unauthorized interception and/or retrieval.\n\n### Extended Description\nNot provided\n\n### Alternative Terms\nNone\n\n### Relationships\nChildOf -> CWE-1390\nChildOf -> CWE-287\nChildOf -> CWE-668\n\n### Mapping Guidance\n**Usage:** Allowed-with-Review\n**Rationale:** This CWE entry is a Class and might have Base-level children that would be more appropriate\n**Comments:** Examine children of this entry to see if there is a better fit\n**Reasons:**\n- Abstraction\n\n\n\n### Observed Examples\n- **CVE-2022-30018:** A messaging platform serializes all elements of User/Group objects, making private information available to adversaries\n- **CVE-2022-29959:** Initialization file contains credentials that can be decoded using a \"simple string transformation\"\n- **CVE-2022-35411:** Python-based RPC framework enables pickle functionality by default, allowing clients to unpickle untrusted data.\n\n Consider specifically these CWEs: CWE-208 CWE-203 CWE-327 CWE-321 CWE-1240 CWE-345 CWE-1391",
    "cwe_mentions": [
      "CWE-208",
      "CWE-203",
      "CWE-327",
      "CWE-321",
      "CWE-1240",
      "CWE-345",
      "CWE-1391"
    ],
    "search_time": 3.755537986755371
  },
  "timestamp": "2025-03-30 18:48:22",
  "cve_id": "unknown",
  "result_count": 10,
  "results": [
    {
      "cwe_id": "385",
      "name": "Covert Timing Channel",
      "type": "base",
      "score": 4.329000000000001,
      "relationship_count": 0
    },
    {
      "cwe_id": "327",
      "name": "Use of a Broken or Risky Cryptographic Algorithm",
      "type": "class",
      "score": 2.984,
      "relationship_count": 0
    },
    {
      "cwe_id": "259",
      "name": "Use of Hard-coded Password",
      "type": "variant",
      "score": 2.9184000000000005,
      "relationship_count": 0
    },
    {
      "cwe_id": "208",
      "name": "Observable Timing Discrepancy",
      "type": "Base",
      "score": 2.9071365730623713,
      "relationship_count": 0
    },
    {
      "cwe_id": "205",
      "name": "Observable Behavioral Discrepancy",
      "type": "base",
      "score": 2.8651999999999997,
      "relationship_count": 0
    },
    {
      "cwe_id": "499",
      "name": "Serializable Class Containing Sensitive Data",
      "type": "variant",
      "score": 2.6784000000000003,
      "relationship_count": 0
    },
    {
      "cwe_id": "498",
      "name": "Cloneable Class Containing Sensitive Information",
      "type": "variant",
      "score": 2.6784000000000003,
      "relationship_count": 0
    },
    {
      "cwe_id": "617",
      "name": "Reachable Assertion",
      "type": "base",
      "score": 2.4699999999999998,
      "relationship_count": 0
    },
    {
      "cwe_id": "321",
      "name": "Use of Hard-coded Cryptographic Key",
      "type": "variant",
      "score": 2.4432,
      "relationship_count": 0
    },
    {
      "cwe_id": "253",
      "name": "Incorrect Check of Function Return Value",
      "type": "base",
      "score": 2.3295999999999997,
      "relationship_count": 0
    }
  ]
}